<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="计算机网络知识点整理, Din&#39;s Blog">
    <meta name="description" content="本文">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>计算机网络知识点整理 | Din&#39;s Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    
    <style>
        body{
            background-image: url(/medias/images/04.png);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/favicon.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Din&#39;s Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/favicon.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Din&#39;s Blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/19.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">计算机网络知识点整理</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">
                                <span class="chip bg-color">计算机网络</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-category">
                                学习笔记
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-07-02
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-07-04
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    30.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    108 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h1><h2 id="1）互联网在信息时代的作用"><a href="#1）互联网在信息时代的作用" class="headerlink" title="1）互联网在信息时代的作用"></a>1）互联网在信息时代的作用</h2><p>互联网具有两个重要的基本特点，及<strong>连通性</strong>和<strong>共享</strong></p>
<h2 id="2）互联网概述"><a href="#2）互联网概述" class="headerlink" title="2）互联网概述"></a>2）互联网概述</h2><h3 id="1、网络的网络"><a href="#1、网络的网络" class="headerlink" title="1、网络的网络"></a>1、网络的网络</h3><p><strong>网络（Network)<strong>由若干</strong>结点(Node)<strong>和连接这些结点的</strong>链路(Link)<strong>组成。<br>多个网络还可以通过路由器互连起来，这样就构成了一个覆盖范围更大的网络，</strong>即互联网（或互连网)<strong>。因此，互联网是“</strong>网络的网络(Netwrok of Networks)</strong> ”。<br>与网络相接的计算机常称为<strong>主机</strong><br>**因特网(Internet)**是世界上最大的互连网络（用户数以亿计，互连的网络数以百万计)。</p>
<blockquote>
<p>internet与Internet的区别<br>internet(互联网或互连网)是一个通用名词，它泛指由多个计算机网络互连而成的网络。在这些网络之间的通信协议可以是任意的。<br>Internet(因特网)则是一个专用名词，它指当前全球最大的、开放的、由众多网络相互连接而成的特定计算机网络，它采用TCP&#x2F;IP协议族作为通信的规则，其前身是美国的ARPANET。</p>
</blockquote>
<h3 id="2、互联网基础结构发展的三个阶段"><a href="#2、互联网基础结构发展的三个阶段" class="headerlink" title="2、互联网基础结构发展的三个阶段"></a>2、互联网基础结构发展的三个阶段</h3><h4 id="发展阶段"><a href="#发展阶段" class="headerlink" title="发展阶段"></a>发展阶段</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667813792434-f1753978-21b6-4d9c-b7bf-5fca8125ff91.png">

<h4 id="ISP与IPX"><a href="#ISP与IPX" class="headerlink" title="ISP与IPX"></a>ISP与IPX</h4><p>互联网服务提供者<strong>ISP(Internet Service Provider)</strong><br>ISP从互联网机构申请到很多IP地址，同时拥有通信链路，路由器等设备。个人通过像ISP缴纳费用，获取IP地址的使用权，即可接入到互联网<br>不同层次：主干，地区，本地<br>为了更快的转发分组。诞生了互联网交换点<strong>IXP(Internet eXchange Point)</strong>,允许两个网络直接相连，常采用工作在数据链路层的网络交换机<br><img src="https://cdn.nlark.com/yuquAAe/0/2022/png/22818239/1667814393414-ce67757e-3dfd-4f73-98d5-8b8cb91e7516.png"></p>
<h3 id="3、互联网的标准化工作"><a href="#3、互联网的标准化工作" class="headerlink" title="3、互联网的标准化工作"></a>3、互联网的标准化工作</h3><h4 id="标准化工作"><a href="#标准化工作" class="headerlink" title="标准化工作"></a>标准化工作</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667814762607-6ce7e82b-cab2-4af3-bfa7-45c5c3f67821.png">

<h4 id="管理机构"><a href="#管理机构" class="headerlink" title="管理机构"></a>管理机构</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667814813596-e732d39c-f729-4ee1-9e06-985a45da1095.png">

<h2 id="3）互联网的组成"><a href="#3）互联网的组成" class="headerlink" title="3）互联网的组成"></a>3）互联网的组成</h2><h3 id="1、互联网的两个部分"><a href="#1、互联网的两个部分" class="headerlink" title="1、互联网的两个部分"></a>1、互联网的两个部分</h3><h4 id="边缘部分"><a href="#边缘部分" class="headerlink" title="边缘部分"></a>边缘部分</h4><p>由所有连接在因特网上的主机组成。这部分是<strong>用户直接使用的</strong>，用来进行通信（传送数据、音频或视频）和资源共享。</p>
<h4 id="核心部分"><a href="#核心部分" class="headerlink" title="核心部分"></a>核心部分</h4><p>由大量网络和连接这些网络的路由器组成。这部分是**为边缘部分提供服务的(提供连通性和交换)**。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667814971794-dc5e1734-382f-4bbc-9654-5a2e29f3649b.png"></p>
<h3 id="2、互联网边缘部分的通信方式"><a href="#2、互联网边缘部分的通信方式" class="headerlink" title="2、互联网边缘部分的通信方式"></a>2、互联网边缘部分的通信方式</h3><p>主要分为客户-服务器方式（C&#x2F;S方式）和对等方式（P2P方式）</p>
<h4 id="客户-服务器方式"><a href="#客户-服务器方式" class="headerlink" title="客户-服务器方式"></a>客户-服务器方式</h4><p>二者都是指通信中所涉及的两个应用的进程<br>客户是服务请求方，服务器使服务提供方</p>
<h4 id="对等方式"><a href="#对等方式" class="headerlink" title="对等方式"></a>对等方式</h4><p>每一台主机既是客户又是服务器，都运行了对等连接软件</p>
<h2 id="4）互联网的核心部分"><a href="#4）互联网的核心部分" class="headerlink" title="4）互联网的核心部分"></a>4）互联网的核心部分</h2><p>在网络核心部分起特殊作用的是路由器，路由器是实现<strong>分组交换</strong>的关键构件</p>
<h3 id="1、三种交换方式介绍"><a href="#1、三种交换方式介绍" class="headerlink" title="1、三种交换方式介绍"></a>1、三种交换方式介绍</h3><h4 id="电路交换-Circuit-Switching"><a href="#电路交换-Circuit-Switching" class="headerlink" title="电路交换(Circuit Switching)"></a>电路交换(Circuit Switching)</h4><p>（1）电话交换机接通电话线的方式称为电路交换;<br>（2）从通信资源的分配角度来看，交换(Switching）就是按照某种方式动态地分配传输线路的资源;<br>（3）电路交换的三个步骤:</p>
<pre><code>  1. 建立连接（(分配通信资源)
  2. 通话（一直占用通信资源)
  3. 释放连接（归还通信资源)
</code></pre>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1667817845628-a9cff622-b520-4862-a045-5bb73c330f85.png">

<h4 id="分组交换-Packet-Switching"><a href="#分组交换-Packet-Switching" class="headerlink" title="分组交换(Packet Switching)"></a>分组交换(Packet Switching)</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667818010911-481c6ac1-a1ca-4fbf-b5be-0ce18f51030b.png">

<blockquote>
<p>每一个数据段前面，加上一些有必要的的控制信息组成首部后，就构成了一个分组。分组又称为包，而分组的首部也可称为包头</p>
</blockquote>
<h4 id="报文交换-Message-Switching"><a href="#报文交换-Message-Switching" class="headerlink" title="报文交换(Message Switching)"></a>报文交换(Message Switching)</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667818305239-25f44155-3b91-4987-a940-7d8c011d7e07.png">

<h4 id="电路交换、报文交换、分组交换的对比"><a href="#电路交换、报文交换、分组交换的对比" class="headerlink" title="电路交换、报文交换、分组交换的对比"></a>电路交换、报文交换、分组交换的对比</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637635829802-7d8c8b81-51ad-41f3-b402-42e75078a0cd.png">

<table>
<thead>
<tr>
<th></th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody><tr>
<td><strong>电路交换</strong></td>
<td>1)通信时延</td>
<td></td>
</tr>
<tr>
<td>2)有序传输</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3)没有冲突</td>
<td></td>
<td></td>
</tr>
<tr>
<td>4)适用范围广</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5)实时性强</td>
<td></td>
<td></td>
</tr>
<tr>
<td>6)控制简单</td>
<td>1)建立连接时间长</td>
<td></td>
</tr>
<tr>
<td>2)线路独占，使用效率低</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3)灵活性差</td>
<td></td>
<td></td>
</tr>
<tr>
<td>4)难以规格化</td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>报文交换</strong></td>
<td>1)无需建立连接</td>
<td></td>
</tr>
<tr>
<td>2)动态分配线路</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3)提高线路可靠性</td>
<td></td>
<td></td>
</tr>
<tr>
<td>4)提高线路利用率</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5)提供多目标服务</td>
<td>1)引起了转发时延</td>
<td></td>
</tr>
<tr>
<td>2)需要较大存储缓存空间</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3)需要传输额外的信息量</td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>分组交换</strong></td>
<td>1)无需建立连接</td>
<td></td>
</tr>
<tr>
<td>2)线路利用率高</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3)简化了存储管理</td>
<td></td>
<td></td>
</tr>
<tr>
<td>4)加速传输</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5)减少出错概率和重发数据量</td>
<td>1)引起了转发时延</td>
<td></td>
</tr>
<tr>
<td>2)需要传输额外的信息量</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3)对于数据报服务。存在失序、丢失或重复分组的问题;对于虚电路服务,存在呼叫建立、数据传输和虚电路释放三个过程</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="5）计算机网络的定义和分类"><a href="#5）计算机网络的定义和分类" class="headerlink" title="5）计算机网络的定义和分类"></a>5）计算机网络的定义和分类</h2><h3 id="1、计算机网络的定义"><a href="#1、计算机网络的定义" class="headerlink" title="1、计算机网络的定义"></a>1、计算机网络的定义</h3><blockquote>
<p>计算机网络的精确定义并未统一</p>
</blockquote>
<p>计算机网络的最简单的定义是:一些互相连接的、自治的计算机的集合。</p>
<ul>
<li><strong>互连</strong>  是指计算机之间可以通过有线或无线的方式进行数据通信;</li>
<li><strong>自治</strong>  是指独立的计算机，它有自己的硬件和软件，可以单独运行使用;</li>
<li><strong>集合</strong>  是指至少需要两台计算机;</li>
</ul>
<p>**计算机网络的较好的定义是:**计算机网络主要是由一些通用的、可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号)。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用。</p>
<ul>
<li>计算机网络所连接的硬件，并不限于一般的计算机，而是包括了智能手机等智能硬件。</li>
<li>计算机网络并非专门用来传送数据，而是能够支持很多种的应用（包括今后可能出现的各种应用)。</li>
</ul>
<h3 id="2、计算机网络的分类"><a href="#2、计算机网络的分类" class="headerlink" title="2、计算机网络的分类"></a>2、计算机网络的分类</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637636469414-19b5c703-a749-4cad-bce7-a15dcdbb9c32.png">

<h2 id="6）计算机网络的性能"><a href="#6）计算机网络的性能" class="headerlink" title="6）计算机网络的性能"></a>6）计算机网络的性能</h2><h3 id="1、计算机网络的性能指标"><a href="#1、计算机网络的性能指标" class="headerlink" title="1、计算机网络的性能指标"></a>1、计算机网络的性能指标</h3><p>| <strong>速率</strong> | <img src="http://rx4hz3911.hd-bkt.clouddn.com/1637637882028-5f4c5622-80d6-4099-a163-daca855a2068.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637637836363-b4813310-7f42-487c-8f40-2a66e557d4ce.png"><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637637952863-82243df5-3907-4890-9f17-1dc404b8a09f.png">&gt; 注意计算时Mb和MB单位的M和大小写B的含义是不同的</p>
<p> |<br>| — | — |<br>| <strong>带宽</strong> | <img src="http://rx4hz3911.hd-bkt.clouddn.com/1637638375121-849cd18c-836f-406b-88d1-fb31b6dff05f.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667821079994-cc7fd9a0-1107-4772-b3a8-6ecaa84b2f32.png"><br>一条通信线路的“频带宽度”越宽，其所传输数据的“最高数据率”也越高。 |<br>| <strong>吞吐量</strong> | </p>
<ul>
<li>吞吐量表示在<strong>单位时间内通过某个网络（(或信道、接口)的数据量。</strong></li>
<li>吞吐量被经常用于对现实世界中的网络的一种测量，以便知道实际上到底有多少数据量能够通过网络。</li>
<li>吞吐量<strong>受网络的带宽或额定速率的限制</strong>。<br>|<br>| <strong>时延</strong> | <img src="http://rx4hz3911.hd-bkt.clouddn.com/1637639200717-a44ae004-42c4-4015-9b59-8c038c7158f8.png"></li>
</ul>
<ul>
<li>processing delay 处理延迟</li>
<li>queuing delay 排队延迟（合并到处理时延）</li>
<li>transmission delay 传输延迟</li>
<li>propagation delay 传播延迟<img src="http://rx4hz3911.hd-bkt.clouddn.com/1667821464531-3ac5a470-8ddd-4132-8b1e-7aa4d694c4f8.png"></li>
</ul>
<p><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637639378615-c3876a49-3d67-4183-ab30-deee1b8bba32.png"> |<br>| <strong>时延带宽积</strong> | <strong>时延带宽积 &#x3D; 传播时延  * 带宽</strong><br>若发送端连续发送数据，则在所发送的第一个比特即将到达终点时，发送端就已经发送了时延带宽积个比特;<br>链路的时延带宽积又称为<strong>以比特为单位的链路长度</strong>。 |<br>| <strong>往返时间</strong> | </p>
<ul>
<li>在许多情况下，因特网上的信息不仅仅单方向传输，而是双向交互;</li>
<li>我们有时很需要知道双向交互一次所需的时间;</li>
<li>因此，**往返时间RTT(Round-Trip Time)**也是一个重要的性能指标。</li>
</ul>
<p><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637639722899-f30b5018-757d-4e11-946a-b279ec23aa19.png"> |<br>| <strong>利用率</strong> | $\color{red}{\bf{利用率}}&#x3D;<br>\left{\begin{array}\<br>\color{blue}{\bf{信道利用率}} \quad  用来表示某信道有百分之几的时间是被利用的（有数据通过).\<br>\color{orange}{\bf{网络利用率}} \quad 全网络的信道利用率的加权平均。<br>\end{array}\right.$</p>
<ul>
<li>根据排队论。当某信道的利用率增大时。该信道引起的时延也会迅速增加;因此，<strong>信道利用率并非越高越好;</strong></li>
<li>如果令$D_0$表示网络空闱时的时延，$D$表示网络当前的时延，那么在适当的假定条件下。可以用下面的简单公式来表示$D、D_0$和利用率$U$之间的关系:</li>
</ul>
<p>$D&#x3D;\frac{D_0}{1-U}$</p>
<ul>
<li>当网络的利用率达到50%时，时延就要加倍;</li>
<li>当网络的利用率超过50%时，时延急剧增大;</li>
<li>当网络的利用率接近100%时，时延就趋于无穷大;</li>
<li>因此。一些拥有较大主干网的ISP通常会拉制它们的信道利用率不超过50%。如果超过了。就要准备扩容，增大线路的带宽。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637643524348-57e7b69f-8738-4134-9f01-4bbf51268ccf.png">

<ol>
<li>也不能使信道利用率太低。这会使宝贵的通信资源被白白浪费。应该使用一些机制，可以根据情况动态调整输入到网络中的通信量。使网络利用率深特在二个合的节围内</li>
</ol>
<p> |<br>| <strong>丢包率</strong> | </p>
<ul>
<li>丢包率即分组丢失率，是指在一定的时间范围内，传输过程中<strong>丢失的分组数量与总分组数量的比率</strong>。</li>
<li>丢包率具体可分为接口丢包率、结点丢包率、链路丢包率、路径丢包率、网络丢包率等。</li>
<li>丢包率是网络运维人员非常关心的一个网络性能指标，但对于普通用户来说往往并不关心这个指标，因为他们通常意识不到网络丢包。</li>
<li>分组丢失主要有两种情况:<ul>
<li><strong>分组</strong>在传输过程中出现<strong>误码</strong>，被结点丢弃;</li>
<li>分组到达一台队列已满的分组交换机时被丢弃;在通信量较大时就可能造成<strong>网络拥塞</strong>。</li>
</ul>
</li>
<li>因此，丢包率反映了网络的拥塞情况:<ul>
<li>无拥塞时路径丢包率为0</li>
<li>轻度拥塞时路径丢包率为1%~4%</li>
<li>严重拥塞时路径丢包率为5%~15%<br>|</li>
</ul>
</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2021/jpeg/587950/1639320897943-b60914cb-d01f-483e-a5bc-a0ac13a4afb7.jpeg" alt="Screenshot_20211212223041.jpg"></p>
<h3 id="2、时延计算"><a href="#2、时延计算" class="headerlink" title="2、时延计算"></a>2、时延计算</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630647734576-46fec6db-a44e-479f-91ca-009cac91a22a.png">

<h2 id="7）、计算机网络体系结构"><a href="#7）、计算机网络体系结构" class="headerlink" title="7）、计算机网络体系结构"></a>7）、计算机网络体系结构</h2><h3 id="1、常见的计算机网络体系结构"><a href="#1、常见的计算机网络体系结构" class="headerlink" title="1、常见的计算机网络体系结构"></a>1、常见的计算机网络体系结构</h3><p>总体来说，将各层的所有协议组合起来，称为<strong>协议栈</strong>。</p>
<h4 id="OSI体系结构"><a href="#OSI体系结构" class="headerlink" title="OSI体系结构"></a>OSI体系结构</h4><p>在因特网协议栈出现以前，OSI模型是ISO组织研发的计算机网络结构模型。OSI的模型一共有7层，从下到上依次为：物理层，链路层，网络层，传输层，<strong>会话层，表示层</strong>，应用层。相比因特网体系结构，OSI多了两层。<br>因特网将两层的功能留给了开发者自行实现。</p>
<blockquote>
<p>OSI的网络层是无连接，面向连接；传输层是面向连接</p>
</blockquote>
<h4 id="TCP-x2F-IP体系结构"><a href="#TCP-x2F-IP体系结构" class="headerlink" title="TCP&#x2F;IP体系结构"></a>TCP&#x2F;IP体系结构</h4><p>因特网的协议栈有4个层次组成<strong>：网络接口层、IP网络层、TCP&#x2F;UDP传输层、应用层</strong><br><strong>网络接口层并没有规定具体内容，</strong>目的是可以互连全世界各种不同的网络接口。<br>各层见下面原理体系结构。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667830968929-d5495655-dd4c-4f1e-8b18-aaa8fdf57401.png"></p>
<h4 id="原理体系结构"><a href="#原理体系结构" class="headerlink" title="原理体系结构"></a>原理体系结构</h4><p>有5个层次组成<strong>：物理层、链路层、网络成、传输层、应用层</strong><br>    <strong>应用层</strong>：应用层协议分布在多个端系统，端系统中的应用程序使用该协议与另一个端系统中的应用程序通信。处于应用层的分组称为<strong>报文</strong>；<br>    <strong>传输层</strong>：传输层在应<strong>用程序端点之间</strong>传输应用层报文，因特网中有两个传输层协议：TCP和UDP。处于传输层的分组称为<strong>报文段</strong>。TCP提供确保传递、流量控制、拥塞控制机制。UDP提供无连接服务，即不提供不必要服务的服务。没有可靠性、没有流量和拥塞控制。<br>    <strong>网络层</strong>：网络层将称为数据报的网络层分组从<strong>一台主机移动到另一台主机</strong>。网络层协议包含著名的IP协议以及其他一些路由选择协议。<strong>数据报</strong><br>  **  链路层<strong>：链路层将称为</strong>帧的链路层分组从一个结点移动到路径上的另一个端点<strong>。一个帧可能被沿途不同链路上的不同链路层协议处理。</strong>帧 **<br>    <strong>物理层</strong>：物理层的任务是将<strong>帧中的比特从一个结点移动到下一个节点</strong>，它提供了传输信息的实际物理通道；<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630395927500-8dfadb00-7cd0-4077-9cd3-6ee365819de8.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630646632593-b44e99cc-5b91-4806-8d2d-acba74236f97.png"></p>
<h4 id="三种协议栈的图表示"><a href="#三种协议栈的图表示" class="headerlink" title="三种协议栈的图表示"></a>三种协议栈的图表示</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630645723339-2b79e19f-eea9-4ec3-841d-17b25fe4609f.png">

<h3 id="2、分层的必要性"><a href="#2、分层的必要性" class="headerlink" title="2、分层的必要性"></a>2、分层的必要性</h3><ul>
<li><strong>计算机网络是个非常复杂的系统</strong>。早在最初的ARPANET设计时就提出了分层的设计理念。</li>
<li>“<strong>分层”可将庞大而复杂的问题，转化为若干较小的局部问题</strong>，而这些较小的局部问题就比较易于研究和处理。</li>
</ul>
<h4 id="各层需要考虑的问题"><a href="#各层需要考虑的问题" class="headerlink" title="各层需要考虑的问题"></a>各层需要考虑的问题</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1667831896242-9af3fa34-ea43-420a-84e4-e2fc1a25809d.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1667831716894-6f78d30b-3aea-446f-83c1-e223a6bad6e8.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1667831984034-b4360538-286b-4057-a389-1e409df549f4.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1667832043556-3bbf41f4-b01e-4ded-9dd0-92cc6e59c629.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1667832104925-8c7774e5-70fe-40e2-81f5-25f3f12baf41.png">

<h3 id="3、分层思想举例"><a href="#3、分层思想举例" class="headerlink" title="3、分层思想举例"></a>3、分层思想举例</h3><blockquote>
<p>一个分组，在不同的层次有不同的称谓，是因为它们经过每一层的时候就被该层封装上了属于该层的相关信息，也就是前面提到的必要信息；于是，每一分层的分组有两种类型的字段：首部字段和有效负载；其中有效负载即为来自上一层的分组数据，而首部字段就是该层加上的必要信息；分组不断被封装以实现各层协议规定的相关功能</p>
</blockquote>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1630396386855-7ef2fbf7-a3ad-494e-af0c-18d565547dbd.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637658856569-b2104350-5c20-40c2-add0-5c6cf5b9dcf4.png">

<h3 id="4、专用术语"><a href="#4、专用术语" class="headerlink" title="4、专用术语"></a>4、专用术语</h3><p><strong>实体(entity) <strong>：任何可发送或接收信息的</strong>硬件或软件进程</strong>。<br><strong>对等实体</strong>：在层次结构中，通信两端位于<strong>相同层次的实体</strong>。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630396489715-5e5ff03b-e084-41fe-bc38-2b94d8deaa64.png"><br><strong>协议数据单元（PDU）</strong>：对等实体之间交换的信息单元。通常上层协议数据单元封装在下层协议数据单元中。<br><strong>虚通信：</strong>对等实体之间的通信，通常需要借助于下层提供的服务完成<br><strong>协议：</strong>控制两个对等实体进行虚通信的规则的集合。<br>_协议栈_是指网络中各层协议的总和<br>协议的三要素：<br>语法：定义所交换信息的格式；<br>语义：定义收发双方所要完成的操作<br>同步：定义收发双方的时序关系<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630396508877-6091890a-1f4c-4e4c-9411-2fce2b376a02.png"><br>在协议的控制下，两个对等实体间的虚通信使得本层能够向上一层提供服务。<br>要实现本层协议，还需要使用下层所提供的服务<br>本层的服务&#x3D;本层的协议+下层的服务<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1630397251027-62345042-3ac4-4d31-b82f-96ed9023e096.png"></p>
<p>协议是“水平的”，即协议是控制对等实体之间通信的规则。<br><strong>服务</strong>是“垂直的”，即服务是由下层向上层通过层间接口提供的。<br>同一系统相邻两层的实体进行交互的地方，称为**服务访问点 SAP (Service Access Point)**。<br><strong>服务访问点</strong>：同一系统相邻两层的实体进行交互的地方。（在同一系统中相邻两层的实体交换信息的逻辑接口，用于区分不同的服务类型。）<br>数据链路层的服务访问点为帧的“类型”字段。<br>网络层的服务访问点为IP数据报首部中的“协议字段”。<br>运输层的服务访问点为“端口号”。<br><strong>服务原语</strong>：上层使用下层所提供的服务必须通过与下层交换一些命令，这些命令称为服务原语。<br><strong>协议数据单元PDU</strong>：对等层次之间传送的数据包称为该层的协议数据单元。<br><strong>服务数据单元SDU</strong>：同一系统内，层与层之间交换的数据包称为服务数据单元。<br>多个SDU可以合成为一个PDU; 一个SDU也可划分为几个PDU。</p>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1630397368521-44f65758-6774-42a3-8a23-b7128a38aa2b.png">
**某层的服务用户只能看见（并使用）下层提供的服务而无法看见下层的协议。**
**下层协议对上层用户是透明的。**

<h2 id="8）总结"><a href="#8）总结" class="headerlink" title="8）总结"></a>8）总结</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2022/xmind/22818239/1667812487856-e754936a-aa2d-45d7-bf53-83b2ca4bbf8b.xmind?_lake_card=%7B%22src%22:%22https://www.yuque.com/attachments/yuque/0/2022/xmind/22818239/1667812487856-e754936a-aa2d-45d7-bf53-83b2ca4bbf8b.xmind%22,%22name%22:%22%E7%AC%AC1%E7%AB%A0%20%E6%A6%82%E8%BF%B0%EF%BC%88%E8%AF%BE%E7%A8%8B%E5%B0%8F%E7%BB%93%EF%BC%89.xmind%22,%22size%22:126759,%22ext%22:%22xmind%22,%22source%22:%22%22,%22status%22:%22done%22,%22download%22:false,%22type%22:%22%22,%22mode%22:%22title%22,%22taskId%22:%22u5addc40f-aa95-4f92-acae-91aa79a3f6e%22,%22taskType%22:%22transfer%22,%22id%22:%22cFztp%22,%22card%22:%22file%22%7D">第1章 概述（课程小结）.xmind</a></p>
<h1 id="二、物理层"><a href="#二、物理层" class="headerlink" title="二、物理层"></a>二、物理层</h1><h2 id="1）物理层的基本概念"><a href="#1）物理层的基本概念" class="headerlink" title="1）物理层的基本概念"></a>1）物理层的基本概念</h2><p>物理层考虑的是<strong>怎样才能在连接各种计算机的传输媒体上传输数据比特流</strong>。<br>物理层为数据链路层屏蔽了各种传输媒体的差异，使数据链路层只需要考虑如何完成本层的协议和服务，而不必考虑网络具体的传输媒体是什么。（透明）<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637659721176-6fa22e39-4d42-469f-8342-80ba33327716.png"></p>
<blockquote>
<p>物理层协议也常称为物理层规程</p>
</blockquote>
<h2 id="2）物理层下面的传输媒体"><a href="#2）物理层下面的传输媒体" class="headerlink" title="2）物理层下面的传输媒体"></a>2）物理层下面的传输媒体</h2><table>
<thead>
<tr>
<th>导引型传输媒体</th>
<th>同轴电缆</th>
<th><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637659953745-3007f285-0c4a-4b1d-9122-a0116c776292.png"></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>双绞线</td>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637659994771-d259be4d-24a3-453d-b5e3-bba6a39f352d.png"></td>
</tr>
<tr>
<td></td>
<td>光纤</td>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660088447-f17a647f-ae19-4dd6-9946-146f4c7003b7.png"></td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660189544-f8c8a260-bc36-4779-8baf-e2951d4853e8.png"></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>电力线</td>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660243324-71c74e4b-3537-42a4-be19-a8c8c4841ffe.png"></td>
</tr>
<tr>
<td>非导引型传输媒体</td>
<td></td>
<td></td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660471353-94b3da28-6858-40d6-b680-1cb922b3b3e2.png"></td>
<td>无线电波</td>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660490054-d73199ce-fff7-44d7-87bb-6a7c35753309.png"></td>
</tr>
<tr>
<td></td>
<td>微波</td>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660365350-352a07c6-f020-4785-bca8-bc543bcaf37b.png"></td>
</tr>
<tr>
<td></td>
<td>红外线</td>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660380117-e0804ed1-e347-4e8a-b1cb-58c9b8f3733d.png"></td>
</tr>
<tr>
<td></td>
<td>可见光</td>
<td></td>
</tr>
</tbody></table>
<h2 id="3）传输方式"><a href="#3）传输方式" class="headerlink" title="3）传输方式"></a>3）传输方式</h2><h3 id="1、串行传输、并行传输"><a href="#1、串行传输、并行传输" class="headerlink" title="1、串行传输、并行传输"></a>1、串行传输、并行传输</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637660895329-c4313c09-b46f-4112-8d78-bd220da64bca.png">
远距离用并行（例如计算机网络）
计算机内部一般用串行

<h3 id="2、同步传输、异步传输"><a href="#2、同步传输、异步传输" class="headerlink" title="2、同步传输、异步传输"></a>2、同步传输、异步传输</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637661072550-c0b09df1-cea4-4ca2-9066-f4225f1aecb8.png">

<h3 id="3、单向通信（单工）、双向交替通信（半双工）、双向同时通信（全双工）"><a href="#3、单向通信（单工）、双向交替通信（半双工）、双向同时通信（全双工）" class="headerlink" title="3、单向通信（单工）、双向交替通信（半双工）、双向同时通信（全双工）"></a>3、单向通信（单工）、双向交替通信（半双工）、双向同时通信（全双工）</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637661097986-d049fe4c-7beb-43d0-b997-8bbce71f54f9.png">

<h2 id="（四）、编码与调制"><a href="#（四）、编码与调制" class="headerlink" title="（四）、编码与调制"></a>（四）、编码与调制</h2><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637664271405-3f7987aa-9e0c-4424-bf8c-80513c033dc9.png">
**码元：**在使用时间域的波形表示数字信号时 ，**代表不同离散数值的基本波形**

<h3 id="1、编码"><a href="#1、编码" class="headerlink" title="1、编码"></a>1、编码</h3><p>不归0编码NRZ<br>归0编码RZ<br>反向不归零编码NRZI，在码元时间内不会出现零电平。若后一个码元时间内所持续的电平与前一个码元时间内所持续的电平不同（也称为电平反转）则表示0，若电平保持不变则表示1。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637665181169-90529e50-9ae4-4182-8ae0-4a69de8efe0f.png"></p>
<h3 id="2、基本调制"><a href="#2、基本调制" class="headerlink" title="2、基本调制"></a>2、基本调制</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637665208307-6f0512c9-5713-4a51-a46e-32cd8ead880c.png">

<h3 id="3、混合调制"><a href="#3、混合调制" class="headerlink" title="3、混合调制"></a>3、混合调制</h3><h4 id="频率、相位、振幅："><a href="#频率、相位、振幅：" class="headerlink" title="频率、相位、振幅："></a>频率、相位、振幅：</h4><p>因为<strong>频率和相位是相关</strong>的，即频率是相位随时间的变化率。所以<strong>一次只能调制频率和相位两个中的一个</strong>。<br>通常情况下，相位和振幅可以结合起来一起调制，称为<strong>正交振幅调制QAM</strong>。</p>
<h4 id="混合调制举例——正交振幅调制QAM"><a href="#混合调制举例——正交振幅调制QAM" class="headerlink" title="混合调制举例——正交振幅调制QAM"></a>混合调制举例——正交振幅调制QAM</h4><ul>
<li>QAM-16<ul>
<li>12种相位</li>
<li>每种相位有1或2种振幅可选可以调制出16种码元(波形)，</li>
<li>每种码元可以对应表示4个比特</li>
<li>码元与4个比特的对应关系采用</li>
<li>格雷码</li>
</ul>
</li>
</ul>
<p>任意两个相邻码元只有1个比特不同<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637665498516-1df87e42-beec-4d2e-944c-547f50a355dd.png"></p>
<h2 id="（五）、信道的极限容量"><a href="#（五）、信道的极限容量" class="headerlink" title="（五）、信道的极限容量"></a>（五）、信道的极限容量</h2><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637665563978-38279242-98fb-4f47-ab59-bc6969105f5e.png">

<h3 id="1、奈氏准则"><a href="#1、奈氏准则" class="headerlink" title="1、奈氏准则"></a>1、奈氏准则</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637665701906-4fbb1125-9c05-4a5d-a0c8-2c8d3bb2234f.png">

<h3 id="2、香农公式"><a href="#2、香农公式" class="headerlink" title="2、香农公式"></a>2、香农公式</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637677572644-b4183bac-6881-4d3f-be07-124d6d91aaad.png">
在信道带宽一定的情况下，根据奈氏准则和香农公式，要想**提高信息的传输速率**就必须采用**多元制**(更好的调制方法)和努力**提高信道中的信噪比**。
自从香农公式发表后，各种**新的信号处理和调制方法就不断出现**，其目的都是为了尽可能地**接近香农公式给出的传输速率极限**。

<h3 id="3、题"><a href="#3、题" class="headerlink" title="3、题"></a>3、题</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637678240227-842c0b80-ef07-400b-9bef-7b2f4b31b80c.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637678446117-54828bdb-d925-495e-8b3d-81d50c8a7d50.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637678559915-e0945baf-bc6f-40fb-960b-ca95b813f9ed.png">

<h2 id="（六）、总结"><a href="#（六）、总结" class="headerlink" title="（六）、总结"></a>（六）、总结</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2022/xmind/22818239/1667812487864-a0c441f6-b66b-49bb-85f2-e6aa926a3261.xmind?_lake_card=%7B%22src%22:%22https://www.yuque.com/attachments/yuque/0/2022/xmind/22818239/1667812487864-a0c441f6-b66b-49bb-85f2-e6aa926a3261.xmind%22,%22name%22:%22%E7%AC%AC2%E7%AB%A0%20%E7%89%A9%E7%90%86%E5%B1%82%20%E7%AB%A0%E8%8A%82%E5%B0%8F%E7%BB%93.xmind%22,%22size%22:57234,%22ext%22:%22xmind%22,%22source%22:%22%22,%22status%22:%22done%22,%22download%22:false,%22type%22:%22%22,%22mode%22:%22title%22,%22taskId%22:%22ub7eda03d-d650-4424-a2a1-23e6681b2d8%22,%22taskType%22:%22transfer%22,%22id%22:%22rDTpD%22,%22card%22:%22file%22%7D">第2章 物理层 章节小结.xmind</a></p>
<h1 id="三、数据链路层"><a href="#三、数据链路层" class="headerlink" title="三、数据链路层"></a>三、数据链路层</h1><h2 id="（一）、概述"><a href="#（一）、概述" class="headerlink" title="（一）、概述"></a>（一）、概述</h2><h3 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h3><p>**链路（Link)**：就是从一个结点到相邻结点的一段物理线路，而中间没有任何其他的交换结点。<br><strong>数据链路(Data Link)：</strong>是指把实现通信协议的硬件和软件加到链路上，就构成了数据链路。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637717282885-ebe4efcc-bb71-4938-a63d-1a7028e73e58.png"></p>
<h3 id="2、点对点信道的数据链路层的三个重要问题"><a href="#2、点对点信道的数据链路层的三个重要问题" class="headerlink" title="2、点对点信道的数据链路层的三个重要问题"></a>2、点对点信道的数据链路层的三个重要问题</h3><p>封装成帧、差错检测、可靠传输</p>
<h3 id="3、使用广播信道的数据链路层"><a href="#3、使用广播信道的数据链路层" class="headerlink" title="3、使用广播信道的数据链路层"></a>3、使用广播信道的数据链路层</h3><p>共享式以太网的媒体接入控制协议CSMA&#x2F;CD<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637717837261-d6c769e3-55bc-40de-af71-b4062432a78e.png"><br>802.11局域网的媒体接入控制协议CSMA&#x2F;CA<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637717935341-324e593c-dc39-4258-98c9-8b83397ca7df.png"></p>
<h3 id="4、数据链路层的互连设备"><a href="#4、数据链路层的互连设备" class="headerlink" title="4、数据链路层的互连设备"></a>4、数据链路层的互连设备</h3><p>网桥和交换机的工作原理<br>集线器（物理层互连设备)与交换机的区别<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637717898259-0c5b5e59-5fc3-48b8-a8f1-3a3f85832b51.png"></p>
<h2 id="（二）、封装成帧"><a href="#（二）、封装成帧" class="headerlink" title="（二）、封装成帧"></a>（二）、封装成帧</h2><ul>
<li>封装成帧是指数据链路层给上层交付的协议数据单元添加帧头和帧尾使之成为帧。<ul>
<li>帧头和帧尾中包含有重要的控制信息。</li>
<li>帧头和帧尾的作用之一就是<strong>帧定界</strong>。</li>
</ul>
</li>
<li>透明传输是指数据链路层对上层交付的传输数据没有任何限制，就好像数据链路层不存在一样。<ul>
<li>面向字节的物理链路使用字节填充（或称字符填充)的方法实现透明传输。</li>
</ul>
</li>
</ul>
<p>（在数据里与定界符相同的字符前填充一个转义字符，在数据其它原有转义字符前也加一个转义字符）</p>
<ul>
<li>面向比特的物理链路使用比特填充的方法实现透明传输。</li>
</ul>
<p>（0比特填充法，例：帧首位定界符为01111110，在每5个连续的1后面填充1个0）<br>高级数据链路控制协议HDLC采用帧头和帧尾中的标志字段作为帧定界符，其值为01111110;<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637718030290-796d7e6c-40f0-49b8-822e-093959eb9016.png"><br>类型字段：指明应用于帧数据字段的协议</p>
<ul>
<li>为了提高帧的传输效率，应当使<strong>帧的数据部分的长度尽可能大些</strong>。</li>
<li>考虑到差错控制等多种因素，每一种数据链路层协议都规定了帧的数据部分的长度上限，即**最大传送单元MTU(Maximum Transfer Unit)**。</li>
</ul>
<h2 id="（三）、差错检测"><a href="#（三）、差错检测" class="headerlink" title="（三）、差错检测"></a>（三）、差错检测</h2><h3 id="1、概述-1"><a href="#1、概述-1" class="headerlink" title="1、概述"></a>1、概述</h3><ul>
<li>实际的通信链路都不是理想的，比特在传输过程中可能会产生差错:1可能会变成0，而0也可能变成1。这称为<strong>比特差错</strong>。</li>
<li>在一段时间内，传输错误的比特占所传输比特总数的比率称为**误码率BER(Bit Error Rate)**。</li>
<li>使用<strong>差错检测码</strong>来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的重要问题之一。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637718909984-52b258ee-7045-4a12-bc89-2ea182d287e2.png">
接收方根据帧尾部中的检错码检测帧中是否有误码。
图示FCS目的是让接收方的数据链路层检查帧在传输过程中是否产生了误码。

<h3 id="2、奇偶校验"><a href="#2、奇偶校验" class="headerlink" title="2、奇偶校验"></a>2、奇偶校验</h3><p>在待发送的数据后面<strong>添加1位奇偶校验位</strong>，使整个数据（包括所添加的校验位在内)中<strong>“1”的个数</strong>为奇数(奇校验)或偶数（(偶校验)。</p>
<ul>
<li>如果有奇数个位发生误码，则奇偶性发生变化，可以检查出误码;</li>
<li>如果有<strong>偶数个位发生误码</strong>，则奇偶性不发生变化，<strong>不能检查出误码（漏检)</strong>;</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637719256118-9228973f-1dca-42c7-b423-517f151efe2d.png">

<h3 id="3、循环冗余校验CRC（Cyclic-Redundary-Check）"><a href="#3、循环冗余校验CRC（Cyclic-Redundary-Check）" class="headerlink" title="3、循环冗余校验CRC（Cyclic Redundary Check）"></a>3、循环冗余校验CRC（Cyclic Redundary Check）</h3><ul>
<li>收发双方约定好一个生成多项式$G(x)$;</li>
<li>发送方基于待发送的数据和生成多项式计算出差错检测码（<strong>冗余码</strong>)，将其添加到待传输数据的后面一起传输;</li>
<li>接收方通过生成多项式来计算收到的数据是否产生了误码;</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637729865021-84b7998a-2c33-46c3-a693-26eaa020ba0f.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637730124757-f9aea4f7-b3ae-4c32-b22a-3fd37770f9e3.png">

<h2 id="（四）、可靠传输"><a href="#（四）、可靠传输" class="headerlink" title="（四）、可靠传输"></a>（四）、可靠传输</h2><h3 id="1、基本概念"><a href="#1、基本概念" class="headerlink" title="1、基本概念"></a>1、基本概念</h3><p>数据链路层向上层提供的服务类型</p>
<ul>
<li><p><strong>不可靠传输服务:</strong> 仅仅丢弃有误码的帧，其他什么也不做;</p>
</li>
<li><p><strong>可靠传输服务</strong>: 想办法实现发送端发送什么，接收端就收到什么。</p>
</li>
<li><p><strong>比特差错</strong>只是传输差错中的一种。</p>
</li>
<li><p>从整个计算机网络体系结构来看，传输差错还包括<strong>分组丢失</strong>、<strong>分组失序</strong>以及<strong>分组重复</strong>。</p>
</li>
<li><p>分组丢失、分组失序以及分组重复这些传输差错，一般不会出现在数据链路层，而会出现在其上层。</p>
</li>
<li><p><strong>可靠传输服务并不仅局限于数据链路层</strong>，其他各层均可选择实现可靠传输。</p>
</li>
<li><p>可靠传输的实现比较复杂，开销也比较大，是否使用可靠传输取决于应用需求。</p>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637730417769-b41b49da-f877-47ee-ba43-9dee2548c954.png">

<h3 id="2、可靠传输的实现机制—停止等待协议SW（Stop-and-Wait）"><a href="#2、可靠传输的实现机制—停止等待协议SW（Stop-and-Wait）" class="headerlink" title="2、可靠传输的实现机制—停止等待协议SW（Stop-and-Wait）"></a>2、可靠传输的实现机制—停止等待协议SW（Stop-and-Wait）</h3><p>像停等协议这样通过确认和重传机制实现的可靠传输协议,常称为<strong>自动请求重传ARQ（Automatic Repeat reQuesty）</strong><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637731293543-32799696-1e42-481e-98c3-fbbe31fa5fd1.png"></p>
<h4 id="（1）超时重传"><a href="#（1）超时重传" class="headerlink" title="（1）超时重传"></a>（1）超时重传</h4><p>接收方收不到数据分组，就不会发送ACK或NAK。如果不采取其他措施，发送方就会一直处于等待接收方ACK或NAK的状态。<br>为解决该问题，可以在发送方发送完一个数据分组时，启动一个超时计时器。若到了超时计时器所设置的重传时间而发送方仍收不到接收方的任何ACK或NAK，则重传原来的数据分组，这就叫做<strong>超时重传</strong>。<br>一般可将重传时间选为略大于“从发送方到接收方的平均往返时间”。</p>
<h4 id="（2）分组重复"><a href="#（2）分组重复" class="headerlink" title="（2）分组重复"></a>（2）分组重复</h4><p>为避免分组重复这种传输错误，必须给每个分组带上序号。<br>对于停止-等待协议，由于每发送一个数据分组就停止等待,只要保证每发送一个新的数据分组，其发送序号与上次发送的数据分组的序号不同就可以了，因此用一个比特来编号就够了。</p>
<h4 id="（3）注意事项"><a href="#（3）注意事项" class="headerlink" title="（3）注意事项"></a>（3）注意事项</h4><ul>
<li>接收端检测到数据分组有误码时，将其丢弃并等待发送方的超时重传。但对于误码率较高的点对点链路，为使发送方尽早重传，也可给发送方发送NAK分组。</li>
<li>为了让接收方能够判断所收到的数据分组是否是重复的，需要给数据分组编号。由于停止-等待协议的停等特性，只需1个比特编号就够了，即编号0和1.</li>
<li>为了让发送方能够判断所收到的ACK分组是否是重复的，需要给ACK分组编号，所用比特数量与数据分组编号所用比特数量一样。数据链路层一般不会出现ACK分组迟到的情况，因此在数据链路层实现停止-等待协议可以不用给ACK分组编号。</li>
<li>超时计时器设置的重传时间应仔细选择。一般可将重传时间选为略大于“从发送方到接收方的平均往返时间”。<ul>
<li>在数据链路层点对点的往返时间比较确定，重传时间比较好设定。</li>
<li>然而在运输层，由于端到端往返时间非常不确定，设置合适的重传时间有时并不容易。</li>
</ul>
</li>
</ul>
<h4 id="（4）停止-等待协议的信道利用率"><a href="#（4）停止-等待协议的信道利用率" class="headerlink" title="（4）停止-等待协议的信道利用率"></a>（4）停止-等待协议的信道利用率</h4><p>$U &#x3D;  \frac{T_D}{T_D+RTT+T_A}$<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637731758267-002500ee-d66f-4199-af24-e065f566e18b.png"><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637732001410-8678dfb6-62f8-4954-afbe-fa77ef9cffee.png"><br>当往返时延RTT远大于数据帧发送时延$T_D$时（例如使用卫星链路)，<strong>信道利用率非常低</strong>。<br>若出现重传，则对于传送有用的数据信息来说，信道利用率还要降低。<br>为了<strong>克服停止-等待协议信道利用率很低的缺点</strong>，就产生了另外两种协议，即后退N帧协议GBN和选择重传协议SR。</p>
<h3 id="3、可靠传输的实现机制—回退N帧协议GBN（Go-Back-N）"><a href="#3、可靠传输的实现机制—回退N帧协议GBN（Go-Back-N）" class="headerlink" title="3、可靠传输的实现机制—回退N帧协议GBN（Go-Back-N）"></a>3、可靠传输的实现机制—回退N帧协议GBN（Go-Back-N）</h3><pre><code>  1. 采用3个比特给分组编序号，即序号0~7;
  2. 发送窗口的尺寸$W_T$的取值: $1&lt;W_T \leq 2^3-1$，本例取$W_T=5$
  3. 接收窗口的尺寸$W_R$的取值: $W_R=1$;
</code></pre>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637733069144-d634492a-bce4-4e00-be75-47c9bc3afd22.png">

<h4 id="（1）累计确认"><a href="#（1）累计确认" class="headerlink" title="（1）累计确认"></a>（1）累计确认</h4><p>即使确认分组丢失,发送方也可能不必重传！（如图假设 发送方发送0-4到达接收端，接收端回复 1ack 和4ack，1ack丢失、4ack到达就说明0-4已经正确送达）<br>接收方不一定要对收到的数据分组逐个发送确认，而是可以在收到几个数据分组后(由具体实现决定)对按序到达的最后一个数据分组发送确认。$ACK_n$表示序号为n以前的所有数据分组都已下确接收。</p>
<h4 id="（2）有差错的情况"><a href="#（2）有差错的情况" class="headerlink" title="（2）有差错的情况"></a>（2）有差错的情况</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637734176399-b308536c-b8b8-4d1d-8a02-c3d9e4041958.png">
发送方收到重复的确认,就知道之前所发送的数据分线出现了差错,于是可以不等超时计时器超时就立刻重传!至于收到几个重复确认就立刻重传,由具体实现决定。

<ul>
<li>在本例中,尽管序号为6.7.0.1的数据分组正确到达接收方。但由于5号数据分组误码不被接受,它们也“受到牵连”而不被接受,发送方还要重传这些数据分组,这就是所	谓的**Go-back-N(回退N帧)**。</li>
<li>可见,当通信线路质量不好时,回退N帧协议的信道利用率并不比停止:等待协议高。</li>
</ul>
<p><strong>若Wr超过取值范围，例如Wr&#x3D;8，会出现什么情况?</strong><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1637734933255-2cdf1940-0255-448c-8d87-9314d05e2c02.png"></p>
<h4 id="（3）总结"><a href="#（3）总结" class="headerlink" title="（3）总结"></a>（3）总结</h4><table>
<thead>
<tr>
<th><strong>发送方</strong></th>
<th><strong>接收方</strong></th>
</tr>
</thead>
</table>
<p>| </p>
<ul>
<li>发送窗口尺寸$W_T$的取值范围是$1&lt;W_T \leq 2^n-1$，其中，n是构成分组序号的比特数量。<ul>
<li>$W_T&#x3D;1$停止-等待协议</li>
<li>$W_T&gt;2^n-1$接收方无法分辨新、旧数据分组</li>
</ul>
</li>
<li>发送方可在未收到接收方确认分组的情况下，将序号落在发送窗口内的多个数据分组全部发送出去;</li>
<li>发送方只有收到对已发送数据分组的确认时，发送窗口才能向前相应滑动;</li>
<li>发送方收到多个重复确认时，可在重传计时器超时前尽早开始重传，由具体实现决定。</li>
<li>发送方发送窗口内某个已发送的数据分组产生超时重发时，其后续在发送窗口内且已发送的数据分组也必须全部重传，这就是<strong>回退N帧协议名称的由来</strong>。<br>| </li>
<li>接收方的接收窗口尺寸$W_R$的取值范围是$W_R&#x3D;1$，因此接收方只能按序接收数据分组。</li>
<li>接收方只接收序号落在接收窗口内且无误码的数据分组，并且将接收窗口向前滑动一个位置，与此同时给发送方发回相应的确认分组。为了减少开销，接收方不一定每收到一个按序到达且无误码的数据分组就给发送方发回一个确认分组,<ul>
<li>而是可以在连续收到好几个按序到达且无误码的数据分组后(由具体实现决定)，才针对最后一个数据分组发送确认分组，这称为<strong>累积确认</strong>;</li>
<li>或者可以在自己有数据分组要发送时才对之前按序接收且无误码的数据分组进行捎带确认;</li>
</ul>
</li>
<li>接收方收到未按序到达的数据分组，除丢弃外，还要对最近按序接收的数据分组进行确认;</li>
</ul>
<p> |</p>
<ul>
<li>回退N帧协议在流水线传输的基础上利用发送窗回来限制发送方连续发送数据分组的数量,是一种<strong>连续ARQ协议</strong>。</li>
<li>在协议的工作过程中发送窗回和接收窗口不断向前滑动,因此这类协议又称为<strong>滑动窗口协议</strong>。</li>
<li>由于回退N帧协议的特性,<strong>当通信线路质量不好时,其信道利用离并不比停止等待协议高</strong>。</li>
</ul>
<h3 id="4、可靠传输的实现机制—选择重传协议SR（Selective-Repeat）"><a href="#4、可靠传输的实现机制—选择重传协议SR（Selective-Repeat）" class="headerlink" title="4、可靠传输的实现机制—选择重传协议SR（Selective Repeat）"></a>4、可靠传输的实现机制—选择重传协议SR（Selective Repeat）</h3><h4 id="（1）Go-Back-N与Selective-Repeat"><a href="#（1）Go-Back-N与Selective-Repeat" class="headerlink" title="（1）Go-Back-N与Selective Repeat"></a>（1）Go-Back-N与Selective Repeat</h4><ul>
<li>回退N帧协议的接收窗口尺寸WR只能等于1，因此接收方只能按序接收正确到达的数据分组。</li>
<li>一个数据分组的误码就会导致其后续多个数据分组不能被接收方按序接收而丢弃（尽管它们无乱序和误码)。这必然会造成发送方对这些数据分组的超时重传，显然这是对通信资源的极大浪费。</li>
<li>为了进一步提高性能，可设法只重传出现误码的数据分组。因此，接收窗口的尺寸WR不应再等于1(而应大于1)，以便接收方先收下失序到达但无误码并且序号落在接收窗口内的那些数据分组，等到所缺分组收齐后再一并送交上层。这就是<strong>选择重传协议</strong>。</li>
<li>注意:</li>
</ul>
<p>选择重传协议为了使发送方仅重传出现差错的分组，接收方不能再采用累积确认，而需要对每个正确接收到的数据分组进行逐一确认!</p>
<h4 id="（2）选择重传协议"><a href="#（2）选择重传协议" class="headerlink" title="（2）选择重传协议"></a>（2）选择重传协议</h4><pre><code>  1. 采用3个比特给分组编序号，即序号0~7;
  2. 发送窗口的尺寸$W_T$的取值: $1&lt;W_T \leq 2^&#123;3-1&#125;$，本例取$W_T=4$
  3. 接收窗口的尺寸$W_R$的取值: $W_R=W_T=4$;
</code></pre>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637736495063-11f2ad83-5826-48ef-806d-d1761b55eb50.png">
GIF演示：
![SR.gif](https://cdn.nlark.com/yuque/0/2021/gif/587950/1637738424764-eb53662c-0501-4313-af2b-4d5b92caf579.gif)

<h4 id="（3）要求"><a href="#（3）要求" class="headerlink" title="（3）要求"></a>（3）要求</h4><table>
<thead>
<tr>
<th><strong>发送方</strong></th>
<th><strong>接收方</strong></th>
</tr>
</thead>
</table>
<p>| </p>
<ul>
<li>发送窗口尺寸$W_T$的取值范围是$1&lt;W_T \leq 2^{n-1}$，其中，n是构成分组序号的比特数量。<ul>
<li>$W_T&#x3D;1$ 与停止-等待协议相同</li>
<li>$W_T&gt;2^{n-1}$接收方无法分辨新、旧数据分组</li>
</ul>
</li>
<li>发送方可在未收到接收方确认分组的情况下，将序号落在发送窗口内的多个数据分组全部发送出去;</li>
<li>发送方只有按序收到对已发送数据分组的确认时，发送窗口才能向前相应滑动;若收到未按序到达的确认分组时，对其进行记录，以防止其相应数据分组的超时重发，但发送窗口不能向前滑动。<br>| </li>
<li>接收方的接收窗口尺寸$W_R$的取值范围是$1&lt;W_R\leq W_T$，因此接收方只能按序接收数据分组。<ul>
<li>$W_R&#x3D;1$与停止-等待协议相同</li>
<li>$W_R&gt;W_T$无意义</li>
</ul>
</li>
<li>接收方可接收未按序到达但没有误码并且序号落在接收窗口内的数据分组;<ul>
<li>为了使发送方仅重传出现差错的分组，接收方不能再采用累积确认，而需要对每个正确接收到的数据分组进行逐一确认!</li>
</ul>
</li>
<li>接收方只有在按序接收数据分组后，接收窗口才能向前相应滑动。<br>|</li>
</ul>
<h2 id="（五）、点对点协议PPP"><a href="#（五）、点对点协议PPP" class="headerlink" title="（五）、点对点协议PPP"></a>（五）、点对点协议PPP</h2><h3 id="1、PPP协议的特点"><a href="#1、PPP协议的特点" class="headerlink" title="1、PPP协议的特点"></a>1、PPP协议的特点</h3><ul>
<li>点对点协议PPP(Point-to-Point Protocol)是目前使用最广泛的点对点数据链路层协议。</li>
</ul>
<h4 id="（1）"><a href="#（1）" class="headerlink" title="（1）"></a>（1）</h4><ul>
<li>PPP协议是因特网工程任务组IETF在1992年制定的。经过1993年和1994年的修订，现在的PPP协议已成为因特网的正式标准[RFC1661,RFC1662]。</li>
</ul>
<p>用户计算机与SP进行通信时，所使用的数据链路层协议通常就是PPP协议。PPP协议也广泛应用于广域网路由器之间的专用线路。<br>在1999年公布的在奥太网上运行的PPP协议，即PPPover Ethernet，简称为PPPoE，它使得lSP可必通过DSL、电路调制解调器、以太网等宽带接入技术以太网接口的形武	为用户提供接入服务。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638886326736-28d70e7c-5775-4932-b9c2-1d5b890164f8.png"></p>
<h4 id="（2）PPP协议的组成"><a href="#（2）PPP协议的组成" class="headerlink" title="（2）PPP协议的组成"></a>（2）PPP协议的组成</h4><p>PPP协议为在点对点链路传输各种协议数据报提供了一个标准方法，主要由以下三部分构成:</p>
<ul>
<li>对各种协议数据报的封装方法(封装成帧)</li>
<li>链路控制协议LCP	用于建立、配置以及测试数据链路的连接</li>
<li>一套网络控制协议NCPs	其中的每一个协议支持不同的网络层协议</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638886805291-c3e9e920-6d35-4552-be81-a74d2b2957d4.png">

<h3 id="2、PPP协议的帧格式"><a href="#2、PPP协议的帧格式" class="headerlink" title="2、PPP协议的帧格式"></a>2、PPP协议的帧格式</h3><h4 id="（1）帧格式"><a href="#（1）帧格式" class="headerlink" title="（1）帧格式"></a>（1）帧格式</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638886909717-ea7f9858-32a7-4426-a3a7-7c2757076c42.png">

<h4 id="（2）字节填充"><a href="#（2）字节填充" class="headerlink" title="（2）字节填充"></a>（2）字节填充</h4><p>透明传输——面向字节的异步链路采用插入转义字符的字节填充法<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889081635-3dc82f07-1c6a-4997-bec9-b24c3e31a4d4.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889106215-4d3fcc5c-2c84-4878-8736-ddcb17c75f29.png"></p>
<h4 id="（3）零填充"><a href="#（3）零填充" class="headerlink" title="（3）零填充"></a>（3）零填充</h4><p>透明传输——面向比特的同步链路采用插入比特0的比特填充法<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889156527-84f54444-11fa-43dd-a1d6-e0cf6ea5d0ac.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889170971-a3fcb211-3211-4c07-9a0f-2e59dc8f1007.png"></p>
<h4 id="（4）差错检测"><a href="#（4）差错检测" class="headerlink" title="（4）差错检测"></a>（4）差错检测</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889308738-7066d70c-754d-4166-a71a-c8bfe48fa198.png">

<h3 id="3、工作状态"><a href="#3、工作状态" class="headerlink" title="3、工作状态"></a>3、工作状态</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889416034-e0c3da9c-398e-4eb7-8213-724f0a09f191.png">

<h2 id="（六）、接入"><a href="#（六）、接入" class="headerlink" title="（六）、接入"></a>（六）、接入</h2><h3 id="1、媒体接入控制的基本概念"><a href="#1、媒体接入控制的基本概念" class="headerlink" title="1、媒体接入控制的基本概念"></a>1、媒体接入控制的基本概念</h3><p>共享信道要着重考虑的一个问题就是如何协调多个发送和接收站点对一个共享传输媒体的占用，即媒体接入控制MAC(Medium Access Control)。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889569473-bbf766d6-e5e6-4267-8192-f118085f6b0c.png"><br>随着技术的发展，交换技术的成熟和成本的降低，具有更高性能的使用点对点链路和链路层交换机的交换式局域网在有线领域已完全取代了共享式局域网，但由于无线信道的广播天性，无线局域网仍然使用的是共享媒体技术。</p>
<h3 id="2、媒体接入控制——静态划分信道"><a href="#2、媒体接入控制——静态划分信道" class="headerlink" title="2、媒体接入控制——静态划分信道"></a>2、媒体接入控制——静态划分信道</h3><h4 id="（1）信道复用"><a href="#（1）信道复用" class="headerlink" title="（1）信道复用"></a>（1）信道复用</h4><p>复用(Multiplexing）是通信技术中的一个重要概念。复用就是通过一条物理线路同时传输多路用户的信号。<br>当网络中传输媒体的传输容量大于多条单一信道传输的总通信量时，可利用复用技术在一条物理线路上建立多条通信信道来充分利用传输媒体的带宽。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889782513-4864f213-9da9-441f-b88e-cc18f4793a5e.png"></p>
<pre><code>  1. **频分复用FDM**
</code></pre>
<p>频分复用的所有用户同时占用不同的频带资源并行通信。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889903934-f97633ab-94d5-4709-a6d1-09050209f788.png"></p>
<pre><code>  2. **时分复用TDM**
</code></pre>
<p>时分复用的所有用户在不同的时间占用同样的频带宽度。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638889945704-901e261e-9646-4de6-b1ec-2d36d03ee164.png"></p>
<pre><code>  3. **波分复用WDM**	
</code></pre>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638890001662-5f9c640b-c9ba-4665-8ee4-8ec5e2e24370.png">

<pre><code>  4. **码分复用CDM**
     1. 码分复用CDM是另一种共享信道的方法。实际上，由于该技术主要用于多址接入，人们更常用的名词是**码分多址CDMA**(Code Division Multiple Access)。
     2. 同理，频分复用FDM和时分复用TDM同样可用于多址接入，相应的名词是频分多址FDMA(Frequency Division Multiple Access)和时分多址TDMA(Time Division Multiple Access)。
     3. 在本课程中，我们不严格区分复用与多址的概念。可简单理解如下:
        - 复用是将单一媒体的频带资源划分成很多子信道，这些子信道之间相互独立，互不干扰。从媒体的整体频带资源上看，每个子信道只占用该媒体频带资源的一部分。
        - 多址（更确切地应该称为多点接入）处理的是动态分配信道给用户。这在用户仅仅暂时性地占用信道的应用中是必须的，而所有的移动通信系统基本上都属于这种情况。相反，在信道永久性地分配给用户的应用中，多址是不需要的(对于无线广播或电视广播站就是这样)。
        - 某种程度上，FDMA、TDMA、CDMA可以分别看成是FDM、TDM、CDM的应用。
     4. 与FDM和TDM不同，CDM的每一个用户可以在同样的时间使用同样的频带进行通信。
     5. 由于各用户使用经过特殊挑选的不同码型，因此各用户之间不会造成干扰。
     6. CDM最初是用于军事通信的，因为这种系统所发送的信号有很强的抗干扰能力，其频谱类似于白噪声，不易被敌人发现。
     7. 随着技术的进步，CDMA设备的价格和体积都大幅度下降，因而现在已广泛用于民用的移动通信中。
     8. **直接序列扩频DSSS**
        1. 在CDMA中，每一个比特时间再划分为m个短的间隔，称为**码片**(Chip)。通常m的值是64或128。为了简单起见，在后续的举例中，我们假设m为8。
        2. 使用CDMA的每一个站被指派一个唯一的**m bit码片序列**(Chip Sequence)。
           - 一个站如果要发送比特1，则发送它自己的m bit码片序列;
           - 一个站如果要发送比特0，则发送它自己的m bit码片序列的二进制反码;
</code></pre>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638890638808-24d5ce67-f5d3-4a85-a9a9-6697e685795f.png">

<pre><code>     3. 码片序列的挑选原则如下:
        1. 分配给每个站的码片序列必须各不相同，实际常采用伪随机码序列。
        2. 分配给每个站的码片序列必须相互正交(规格化内积为0)。
</code></pre>
<p>令向量S表示站S的码片序列，令向量T表示其他任何站的码片序列。<br>两个不同站S和T的码片序列正交，就是向量S和T的规格化内积为0：$S·T \equiv \frac{1}{m} \sum^m_{i&#x3D;1}S_i T_i&#x3D;0$<br>任何一个码片向量和其它各站码片反码的向量的内积是0：$S·\bar{T} \equiv 0$<br>任何一个码片向量和该码片向量自己的规格化内积是1：$S\cdot S \equiv 1$<br>任何一个码片向量和该码片反码的向量的内积是-1：$S\cdot \bar{S} \equiv -1$<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638891630142-5df87a55-da9c-4bfa-a6c6-2bc636637058.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638891778744-9acfa8ee-c780-4023-8305-99d363402c57.png"></p>
<h3 id="3、随机接入——CSMA-x2F-CD协议"><a href="#3、随机接入——CSMA-x2F-CD协议" class="headerlink" title="3、随机接入——CSMA&#x2F;CD协议"></a>3、随机接入——CSMA&#x2F;CD协议</h3><h4 id="（1）CSMA-x2F-CD协议"><a href="#（1）CSMA-x2F-CD协议" class="headerlink" title="（1）CSMA&#x2F;CD协议"></a>（1）CSMA&#x2F;CD协议</h4><p>CSMA&#x2F;CD协议曾经用于各种总线结构以太网和双绞线以太网的早期版本中。<br>现在的以太网基于交换机和全双工连接,不会有碰撞,因此没有必要使用CSMA&#x2F;CD协议。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638950213654-7b4656c0-dbd2-403a-9a50-18130eef073b.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638950290017-e7bbe4a1-ca84-41e1-a549-e9a95024d8bf.png"></p>
<h4 id="（2）争用期（碰撞窗口）"><a href="#（2）争用期（碰撞窗口）" class="headerlink" title="（2）争用期（碰撞窗口）"></a>（2）争用期（碰撞窗口）</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638950496624-1dc3c49a-91c7-4a66-a02e-668d80668f7f.png">

<h4 id="（3）最小帧长"><a href="#（3）最小帧长" class="headerlink" title="（3）最小帧长"></a>（3）最小帧长</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638950604273-18be08c3-634d-40d7-94cc-318b2792956c.png">

<h4 id="（4）最大帧长"><a href="#（4）最大帧长" class="headerlink" title="（4）最大帧长"></a>（4）最大帧长</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951054791-74211b0a-611e-4350-8d4b-d051ef773e13.png">

<h4 id="（5）截断二进制指数退避算法"><a href="#（5）截断二进制指数退避算法" class="headerlink" title="（5）截断二进制指数退避算法"></a>（5）截断二进制指数退避算法</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951169754-25f89465-7bd5-4f40-985c-c4f603861d49.png">
k从重传次数和10中取小者

<h4 id="（6）信道利用率"><a href="#（6）信道利用率" class="headerlink" title="（6）信道利用率"></a>（6）信道利用率</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951443265-787a6b7c-18ed-462d-a63f-de6cd0c7eded.png">

<h4 id="（7）帧发送流程"><a href="#（7）帧发送流程" class="headerlink" title="（7）帧发送流程"></a>（7）帧发送流程</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951492369-cf93efbc-50fc-46de-9368-4e0fb07a533c.png">

<h4 id="（8）帧接收流程"><a href="#（8）帧接收流程" class="headerlink" title="（8）帧接收流程"></a>（8）帧接收流程</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951528879-eeb9ac17-7a40-4ff2-90b4-4fba8935e8c2.png">

<h4 id="（9）例题"><a href="#（9）例题" class="headerlink" title="（9）例题"></a>（9）例题</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951619992-90e1a216-02af-4bc7-a265-47b19fce7964.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638951846564-9142f10f-9395-42de-ab8b-bc08359dad4b.png">

<h3 id="4、随机接入——CSMA-x2F-CA协议"><a href="#4、随机接入——CSMA-x2F-CA协议" class="headerlink" title="4、随机接入——CSMA&#x2F;CA协议"></a>4、随机接入——CSMA&#x2F;CA协议</h3><h4 id="（1）引入"><a href="#（1）引入" class="headerlink" title="（1）引入"></a>（1）引入</h4><blockquote>
<p>既然CSMA&#x2F;CD协议已经成功地应用于使用广播信道的有线局域网，那么同样使用广播信道的无线局域网能不能也使用CSMA&#x2F;CD协议呢?</p>
</blockquote>
<ul>
<li>在无线局域网中，仍然可以使用载波监听多址接入CSMA，即在发送帧之前先对传输媒体进行载波监听。若发现有其他站在发送帧，就推迟发送以免发生碰撞。</li>
<li>在无线局域网中，不能使用碰撞检测CD，原因如下:<ul>
<li>由于无线信道的传输条件特殊，其信号强度的动态范围非常大，无线网卡上接收到的信号强度往往会远远小于发送信号的强度（可能相差百万倍)。如果要在无线网卡上实现碰撞检测CD，对硬件的要求非常高。</li>
<li>即使能够在硬件上实现无线局域网的碰撞检测功能，但由于无线电波传播的特殊性（存在隐蔽站问题)，进行碰撞检测的意义也不大。</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638952508181-d2f6071d-9fa1-4fb2-8a9d-cdc02e0bfd4c.png">

<h4 id="（2）载波监听多址接入-x2F-碰撞避免CSMA-x2F-CA-Carrier-Sense-Multiple-Access-x2F-Collision-Avoidance"><a href="#（2）载波监听多址接入-x2F-碰撞避免CSMA-x2F-CA-Carrier-Sense-Multiple-Access-x2F-Collision-Avoidance" class="headerlink" title="（2）载波监听多址接入&#x2F;碰撞避免CSMA&#x2F;CA(Carrier Sense Multiple Access&#x2F;Collision Avoidance)"></a>（2）载波监听多址接入&#x2F;碰撞避免CSMA&#x2F;CA(Carrier Sense Multiple Access&#x2F;Collision Avoidance)</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638952713027-2f07cade-2494-4395-8f98-ef958939f589.png">

<h4 id="（3）帧间间隔IFS-InterFrame-Space"><a href="#（3）帧间间隔IFS-InterFrame-Space" class="headerlink" title="（3）帧间间隔IFS(InterFrame Space)"></a>（3）帧间间隔IFS(InterFrame Space)</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638952891316-eceb1ac8-4eac-4425-a50f-274b6e502733.png">

<h4 id="（4）CSMA-x2F-CA协议的工作原理"><a href="#（4）CSMA-x2F-CA协议的工作原理" class="headerlink" title="（4）CSMA&#x2F;CA协议的工作原理"></a>（4）CSMA&#x2F;CA协议的工作原理</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638953037206-9e130dfc-0fb9-42e6-944f-65e8e755003a.png">

<h4 id="（5）CSMA-x2F-CA协议的退避算法"><a href="#（5）CSMA-x2F-CA协议的退避算法" class="headerlink" title="（5）CSMA&#x2F;CA协议的退避算法"></a>（5）CSMA&#x2F;CA协议的退避算法</h4><ul>
<li>在执行退避算法时，站点为退避计时器设置一个随机的退避时间:<ul>
<li>当退避计时器的时间减小到零时，就开始发送数据;</li>
<li>当退避计时器的时间还未减小到零时而信道又转变为忙状态，这时就冻结退避计时器的数值，重新等待信道变为空闲，再经过时间DIFS后，继续启动退避计时器。</li>
</ul>
</li>
<li>在进行第i次退避时，退避时间在时隙编号{0，1，…，2^(2+i)-1}中随机选择一个，然后乘以基本退避时间（也就是一个时隙的长度）就可以得到随机的退避时间。这样做是为了使不同站点选择相同退避时间的概率减少。当时隙编号达到255时(对应于第6次退避)就不再增加了。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638953511496-de36ddc1-a9a8-4196-8b1b-1377230cde03.png">

<h4 id="（6）CSMA-x2F-CA协议的信道预约和虚拟载波监听"><a href="#（6）CSMA-x2F-CA协议的信道预约和虚拟载波监听" class="headerlink" title="（6）CSMA&#x2F;CA协议的信道预约和虚拟载波监听"></a>（6）CSMA&#x2F;CA协议的信道预约和虚拟载波监听</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638953755000-fe6c17e2-6e3e-4152-9a35-516fe92da93c.png">

<h4 id="（7）例题"><a href="#（7）例题" class="headerlink" title="（7）例题"></a>（7）例题</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638953844186-051e544d-985b-4f7c-8015-5ae8b626878e.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638953907435-9f95ed88-2587-47fd-946a-53490278107e.png">

<h2 id="（七）、MAC地址、IP地址以及ARP协议"><a href="#（七）、MAC地址、IP地址以及ARP协议" class="headerlink" title="（七）、MAC地址、IP地址以及ARP协议"></a>（七）、MAC地址、IP地址以及ARP协议</h2><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638953993265-fd6cad37-dde7-4cb0-951f-b14aeabb0116.png">

<h3 id="1、MAC地址"><a href="#1、MAC地址" class="headerlink" title="1、MAC地址"></a>1、MAC地址</h3><ul>
<li><p>当多个主机连接在同一个广播信道上，要想实现两个主机之间的通信，则每个主机都必须有一个唯一的标识，即一个数据链路层地址;</p>
</li>
<li><p>在每个主机发送的帧中必须携带标识发送主机和接收主机的地址。由于这类地址是用于媒体接入控制MAC(Media Access Control)，因此这类地址被称为<strong>MAC地址</strong>;</p>
<ul>
<li>MAC地址一般被固化在网卡(网络适配器）的电可擦可编程只读存储器EEPROM中，因此MAC地址也被称为硬件地址;</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638954229080-3e1a54bc-e560-49e6-8524-475a3f76b559.png">

<ul>
<li>MAC地址有时也被称为物理地址。<strong>请注意:这并不意味着MAC地址属于网络体系结构中的物理层!</strong></li>
<li>一般情况下，用户主机会包含两个网络适配器:有线局域网适配器（有线网卡）和无线局域网适配器（无线网卡)。每个网络适配器都有一个全球唯一的MAC地址。而交换机和路由器往往拥有更多的网络接口，所以会拥有更多的MAC地址。综上所述，严格来说，MAC地址是对网络上各接口的唯一标识，而不是对网络上各设备的唯一标识。</li>
</ul>
<h4 id="（1）IEEE-802局域网的MAC地址格式"><a href="#（1）IEEE-802局域网的MAC地址格式" class="headerlink" title="（1）IEEE 802局域网的MAC地址格式"></a>（1）IEEE 802局域网的MAC地址格式</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638954407782-0ed93a73-6f4d-4e5a-af93-e676a45d0956.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638954552244-63a24aff-1361-46e0-9e2c-ee015a8ee856.png">

<h4 id="（2）IEEE-802局域网的MAC地址发送顺序"><a href="#（2）IEEE-802局域网的MAC地址发送顺序" class="headerlink" title="（2）IEEE 802局域网的MAC地址发送顺序"></a>（2）IEEE 802局域网的MAC地址发送顺序</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638954733427-71669a4d-5381-4982-b294-e8422f07f76c.png">

<h4 id="（3）单播MAC地址举例"><a href="#（3）单播MAC地址举例" class="headerlink" title="（3）单播MAC地址举例"></a>（3）单播MAC地址举例</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638954794236-3ce44818-5004-4224-98f1-501f53c46aab.png">

<h4 id="（4）广播MAC地址举例"><a href="#（4）广播MAC地址举例" class="headerlink" title="（4）广播MAC地址举例"></a>（4）广播MAC地址举例</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638954839395-78ee4836-edb1-405d-89b7-63e84ca72110.png">

<h4 id="（5）多播MAC地址举例"><a href="#（5）多播MAC地址举例" class="headerlink" title="（5）多播MAC地址举例"></a>（5）多播MAC地址举例</h4><p>![(<code>75@(R4PV</code>]2Y0Z]JFGAI2.png](<a target="_blank" rel="noopener" href="http://rx4hz3911.hd-bkt.clouddn.com/1638955092547-7986c2c0-0148-49be-a084-7142cc50b82f.png%22%3E">http://rx4hz3911.hd-bkt.clouddn.com/1638955092547-7986c2c0-0148-49be-a084-7142cc50b82f.png&quot;&gt;</a></p>
<h4 id="（6）随机MAC地址"><a href="#（6）随机MAC地址" class="headerlink" title="（6）随机MAC地址"></a>（6）随机MAC地址</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638955152245-290a9551-eb4f-4ef4-befd-872efc9941cd.png">

<h3 id="2、IP地址"><a href="#2、IP地址" class="headerlink" title="2、IP地址"></a>2、IP地址</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638955342617-98bb14b9-a683-4226-b0a6-d74bc1937987.png">

<h4 id="数据包转发过程中IP地址与MAC地址的变化情况"><a href="#数据包转发过程中IP地址与MAC地址的变化情况" class="headerlink" title="数据包转发过程中IP地址与MAC地址的变化情况"></a>数据包转发过程中IP地址与MAC地址的变化情况</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638955540271-6e5cf38b-623f-4980-95d5-44979ce2306d.png">

<h3 id="3、ARP协议"><a href="#3、ARP协议" class="headerlink" title="3、ARP协议"></a>3、ARP协议</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638955760998-c689f779-06ed-4560-ad59-cf958a41d6ec.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638955797659-33c361f3-6c84-42a3-b5ef-5ce6f6975a74.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638955830883-ffb5b531-67ce-4bd4-a019-534e8693281b.png">

<ul>
<li>主机在自己的ARP高速缓存表中查找目的主机的P地址所对应的MAC地址。若找到了。则可以封装MAC帧进行发送;若找不到，则发送ARP请求(封装在广播MAC帧中):</li>
<li>目的主机收到ARP请求后，将源主机的IP地址与MAC地址记录到自己的ARP高速缓存表中，然后给源主机发送ARP响应(封装在单播MAC帧中)，ARP响应中包含有目的主机的IP地址和MAC地址;</li>
<li>源主机收到ARP响应后。将目的主机的IP地址与MAC地址记录到自己的ARP高速缓存表中，然后就可以封装之前想发送的MAC帧并发送给目的主机:</li>
<li><strong>ARP的作用范围：逐段链路或逐个网络使用;</strong></li>
<li>除ARP请求和响应外。ARP还有其他类型的报文（例如 用于检查IP地址冲交的“无故ARP、免费ARP(Gratuitous ARP)” ):</li>
<li>ARP没有安全验证机制,存在ARP欺骗(攻击)问题。</li>
</ul>
<h2 id="（八）、集线器与交换机"><a href="#（八）、集线器与交换机" class="headerlink" title="（八）、集线器与交换机"></a>（八）、集线器与交换机</h2><h3 id="1、集线器与交换机的区别"><a href="#1、集线器与交换机的区别" class="headerlink" title="1、集线器与交换机的区别"></a>1、集线器与交换机的区别</h3><h4 id="（1）总线型以太网和星型以太网"><a href="#（1）总线型以太网和星型以太网" class="headerlink" title="（1）总线型以太网和星型以太网"></a>（1）总线型以太网和星型以太网</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638956250110-d170aedc-a291-40e5-88a8-5d00a219d2ee.png">

<h4 id="（2）、集线器与交换机的区别"><a href="#（2）、集线器与交换机的区别" class="headerlink" title="（2）、集线器与交换机的区别"></a>（2）、集线器与交换机的区别</h4><p>忽略ARP过程<br>假设交换机的帧交换表已“学习好了</p>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638956823964-c7071674-d2c8-4977-9651-cccf6f5e515e.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638956420641-3a948942-3ded-4e59-af1c-f397effce65a.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638956599863-edeec90f-ac82-4fba-82ac-608656f0561d.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638956805098-767833d2-51ed-4454-826a-8c8f4532bc2d.png">

<h3 id="2、以太网交换机自学习和转发帧的流程"><a href="#2、以太网交换机自学习和转发帧的流程" class="headerlink" title="2、以太网交换机自学习和转发帧的流程"></a>2、以太网交换机自学习和转发帧的流程</h3><ul>
<li>以太网交换机工作在数据链路层（也包括物理层)</li>
<li>以太网交换机收到帧后，在帧交换表中查找帧的目的MAC地址所对应的接口号，然后通过该接口转发帧。</li>
<li>以太网交换机是一种即插即用设备，刚上电启动时其内部的帧交换表是空的。随着网络中各主机间的通信，以太网交换机通过自学习算法自动逐渐建立起帧交换表。</li>
</ul>
<p>假设各主机知道网络中其他各主机的MAC地址(无需进行ARP)<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638957316188-d3a55705-d622-479f-bf77-6a380f6567c5.png"></p>
<h4 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638957392161-53227174-30c1-4609-a15b-eb8b31e3626e.png">

<h4 id="小节"><a href="#小节" class="headerlink" title="小节"></a>小节</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638957544090-9b4862f9-5c26-4d10-a63d-f0b4293304b2.png">

<h3 id="3、以太网交换机的生成树协议STP"><a href="#3、以太网交换机的生成树协议STP" class="headerlink" title="3、以太网交换机的生成树协议STP"></a>3、以太网交换机的生成树协议STP</h3><h4 id="（1）概述"><a href="#（1）概述" class="headerlink" title="（1）概述"></a>（1）概述</h4><blockquote>
<p>如何提高以太网的可靠性?</p>
</blockquote>
<p>添加冗余链路可以提高以太网的可靠性，但是，冗余链路也会带来负面效应——形成网络环路<br>网络环路会带来以下问题:</p>
<ul>
<li>广播风暴</li>
</ul>
<p>大量消耗网络资源，使得网络无法正常转发其他数据帧;</p>
<ul>
<li>主机收到重复的广播帧</li>
</ul>
<p>大量消耗主机资源</p>
<ul>
<li>交换机的帧交换表震荡（漂移)</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638957914465-7e1b9a65-1388-4350-878c-64e149e21e14.png">

<h4 id="（2）生成树协议STP-Spanning-Tree-Protocol"><a href="#（2）生成树协议STP-Spanning-Tree-Protocol" class="headerlink" title="（2）生成树协议STP(Spanning Tree Protocol)"></a>（2）生成树协议STP(Spanning Tree Protocol)</h4><p>以太网交换机使用生成树协议STP(Spanning Tree Protocol),可以在增加冗余链路来提高网络可靠性的同时又避免网络环路带来的各种问题。</p>
<ul>
<li>不论交换机之间采用怎样的物理连接，交换机都能够自动计算并构建一个逻辑上没有环路的网络，其逻辑拓扑结构必须是树型的(无逻辑环路);</li>
<li>最终生成的树型逻辑拓扑要确保连通整个网络;</li>
<li>当首次连接交换机或网络物理拓扑发生变化时(有可能是人为改变或故障)，交换机都将进行生成树的重新计算。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638957999743-fe3b0923-cebc-4086-acfe-09763fb57a32.png">


<h2 id="（九）、虚拟局域网VLAN"><a href="#（九）、虚拟局域网VLAN" class="headerlink" title="（九）、虚拟局域网VLAN"></a>（九）、虚拟局域网VLAN</h2><h3 id="1、概述-2"><a href="#1、概述-2" class="headerlink" title="1、概述"></a>1、概述</h3><h4 id="（1）广播域"><a href="#（1）广播域" class="headerlink" title="（1）广播域"></a>（1）广播域</h4><ul>
<li>以太网交换机工作在数据链路层（也包括物理层)</li>
<li>使用一个或多个以太网交换机互连起来的交换式以太网，其所有站点都属于同一个广播域。</li>
<li>随着交换式以太网规模的扩大，广播域相应扩大。</li>
<li>巨大的广播域会带来很多弊端:<ul>
<li>广播风暴<ul>
<li>广播风暴会浪费网络资源和各主机的CPU资源!</li>
</ul>
</li>
<li>难以管理和维护</li>
<li>潜在的安全问题</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638958293550-19a8eee1-f6a6-4af1-a7ae-3e2537269036.png">

<h4 id="（2）分割广播域的方法"><a href="#（2）分割广播域的方法" class="headerlink" title="（2）分割广播域的方法"></a>（2）分割广播域的方法</h4><ul>
<li>使用路由器可以隔离广播域</li>
</ul>
<p>路由器的成本较高，大规模使用不现实<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638958451468-467000b7-90b0-40f1-9b25-57b82c843179.png"></p>
<ul>
<li>虚拟局域网VLAN技术应运而生</li>
</ul>
<p><strong>虚拟局域网VLAN(Virtual Local Area Network)<strong>是一种将局域网内的</strong>设备划分成与物理位置无关的逻辑组的技术，这些逻辑组具有某些共同的需求</strong>。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638958554783-8cc344e2-7e2e-4789-8ac9-6e68455a4e93.png"></p>
<h3 id="2、虚拟局域网VLAN的实现机制"><a href="#2、虚拟局域网VLAN的实现机制" class="headerlink" title="2、虚拟局域网VLAN的实现机制"></a>2、虚拟局域网VLAN的实现机制</h3><h4 id="（1）IEEE-802-1Q帧"><a href="#（1）IEEE-802-1Q帧" class="headerlink" title="（1）IEEE 802.1Q帧"></a>（1）IEEE 802.1Q帧</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638958657922-fd38a288-879f-4292-918b-5b6bcc182b09.png">

<h4 id="（2）交换机的端口类型"><a href="#（2）交换机的端口类型" class="headerlink" title="（2）交换机的端口类型"></a>（2）交换机的端口类型</h4><p>交换机的端口类型有以下三种:Access、Trunk、Hybrid<br>交换机各端口的缺省VLAN ID</p>
<ul>
<li>在思科交换机上称为Native VLAN，即本征VLAN。</li>
<li>在华为交换机上称为Port VLAN ID，即端口VLAN ID，简记为PVID。</li>
<li><strong>Access端口</strong><ul>
<li>Access端口一般用于连接用户计算机Access端口只能属于一个VLAN</li>
<li>Access端口的PVID值与端口所属VLAN的ID相同（默认为1)</li>
<li>Access端口接收处理方法:<ul>
<li>一般只接受“未打标签”的普通以太网MAC帧。根据接收帧的端口的PVID给帧“打标签”，即插入4字节VLAN标记字段，字段中的VID取值与端口的PVID取值相等。</li>
</ul>
</li>
<li>Access端口发送处理方法:<ul>
<li>若帧中的VID与端口的PVID相等，则“去标签”并转发该帧;否则不转发。</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638958915966-2f052d22-4725-498e-ac92-e5a7e3d42c27.png">

<ul>
<li><strong>Trunk端口</strong><ul>
<li>Trunk端口一般用于交换机之间或交换机与路由器之间的互连</li>
<li>Trunk端口可以属于多个VLAN</li>
<li>用户可以设置Trunk端口的PVID值。默认情况下，Trunk端口的PVID值为1。</li>
<li>Trunk端口发送处理方法:<ul>
<li>对VID等于PVID的帧，“去标签”再转发;</li>
<li>对VID不等于PVID的帧，直接转发;</li>
</ul>
</li>
<li>Trunk端口接收处理方法;<ul>
<li>接收“未打标签”的帧，根据接收帧的端口的PVID给帧“打标签”，即插入4字节VLAN标记字段，字段中的VID取值与端口的PVID取值相等。</li>
<li>对VID不等于PVID的帧，直接转发;</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638959193377-ed19217f-3648-4fae-89ca-1d2665e48f7a.png">

<ul>
<li>Hybrid端口<ul>
<li>Hybrid端口既可用于交换机之间或交换机与路由器之间的互连(同Trunk端口)，也可用于交换机与用户计算机之间的互连(同Access端口)</li>
<li>Hybrid端口可以属于多个VLAN(同Trun端口)</li>
<li>用户可以设置Hybrid端口的PVID值。默认情况下,Hybrid端口的PVID值为1(同Trun端口)</li>
<li>Hybrid端口发送处理方法(与Trunk端口不同)<ul>
<li>查看倾的VID是否在端口的“去标签”列表中:<ul>
<li>若存在。则“去标签”后再转发;</li>
<li>若不存在，则直接转发;</li>
</ul>
</li>
</ul>
</li>
<li>Hybrid端口接收处理方法(同Trunk端口)<ul>
<li>接收“未打标签”的帧。根据接收帧的端口的PVID给帧“打标签”，即插入4字节VLAN标记字段，字段中的VID取值与端口的PVID取值相等。</li>
<li>接收“已打标签的帧”;</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638959675465-f3953e36-abb7-4f3b-babb-6f0ab91ef757.png">

<h4 id="（3）小节"><a href="#（3）小节" class="headerlink" title="（3）小节"></a>（3）小节</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638959612494-33bd68d9-dc12-40e4-b5d8-db42b4718997.png">

<h1 id="四、网络层"><a href="#四、网络层" class="headerlink" title="四、网络层"></a>四、网络层</h1><h2 id="（一）、概述-1"><a href="#（一）、概述-1" class="headerlink" title="（一）、概述"></a>（一）、概述</h2><ul>
<li>网络层的主要任务是实现网络互连，进而实现数据包在各网络之间的传输。</li>
<li>要实现网络层任务，需要解决以下主要问题:<ul>
<li>网络层向运输层提供怎样的服务（“可靠传输”还是“不可靠传输”)</li>
<li>网络层寻址问题</li>
<li>路由选择问题</li>
</ul>
</li>
<li>因特网(lnternet)是目前全世界用户数量最多的互联网，它使用TCP&#x2F;IP协议栈。</li>
<li>由于TCP&#x2F;IP协议栈的网络层使用网际协议IP，它是整个协议栈的核心协议，因此在TCP&#x2F;IP协议栈中网络层常称为网际层。</li>
<li>综上所述，我们通过学习TCP&#x2F;IP协议栈的网际层来学习网络层的理论知识和实践技术。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638960030327-5c1932d9-9791-4360-a13a-77017a6be506.png">

<h2 id="（二）、网络层提供的两种服务"><a href="#（二）、网络层提供的两种服务" class="headerlink" title="（二）、网络层提供的两种服务"></a>（二）、网络层提供的两种服务</h2><h3 id="1、面向连接的虚电路服务"><a href="#1、面向连接的虚电路服务" class="headerlink" title="1、面向连接的虚电路服务"></a>1、面向连接的虚电路服务</h3><ul>
<li>可靠通信由网络来保证</li>
<li>必须建立网络层的连接——虚电路VC(Virtual Circuit)</li>
<li>通信双方沿着已建立的虚电路发送分组</li>
<li>目的主机的地址仅在连接建立阶段使用，之后每个分组的首部只需携带一条虚电路的编号(构成虚电路的每一段链路都有一个虚电路编号)。</li>
<li>这种通信方式如果再使用可靠传输的网络协议，就可使所发送的分组最终正确到达接收方(无差错按序到达、不丢失、不重复)。</li>
<li>通信结束后，需要释放之前所建立的虚电路。</li>
<li>很多广域分组交换网都使用面向连接的虚电路服务。例如，曾经的X.25和逐渐过时的帧中继FR、异步传输模式ATM等。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638960620150-9e0316fa-acc8-4176-be31-d6b322e92570.png">

<h3 id="2、无连接的数据报服务"><a href="#2、无连接的数据报服务" class="headerlink" title="2、无连接的数据报服务"></a>2、无连接的数据报服务</h3><ul>
<li>可靠通信应当由用户主机来保证</li>
<li>不需要建立网络层连接</li>
<li>每个分组可走不同的路径</li>
<li>每个分组的首部必须携带目的主机的完整地址</li>
<li>这种通信方式所传送的分组可能误码、丢失、重复和失序。</li>
<li>由于网络本身不提供端到端的可靠传输服务，这就使网络中的路由器可以做得比较简单，而且价格低廉(与电信网的交换机相比较)。</li>
<li>因特网采用了这种设计思想，也就是将复杂的网络处理功能置于因特网的边缘(用户主机和其内部的运输层)，而将相对简单的尽最大努力的分组交付功能置于因特网核心。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1638960654093-50f661c9-764d-442d-8210-8234ac3080d3.png">

<h3 id="3、小节"><a href="#3、小节" class="headerlink" title="3、小节"></a>3、小节</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1638960743120-deea5fd1-0517-48c5-8284-ff5b73a508ca.png">

<h2 id="（三）、IPv4地址"><a href="#（三）、IPv4地址" class="headerlink" title="（三）、IPv4地址"></a>（三）、IPv4地址</h2><h3 id="1、概述-3"><a href="#1、概述-3" class="headerlink" title="1、概述"></a>1、概述</h3><ul>
<li>在TCP&#x2F;IP体系中，IP地址是一个最基本的概念，我们必须把它弄清楚。</li>
<li>IPv4地址就是给因特网(Internet)上的每一台主机(或路由器）的每一个接口分配一个在全世界范围内是唯一的32比特的标识符。</li>
<li>IP地址由因特网名字和数字分配机构ICANN(Internet Corporation for Assigned Names and Numbers)进行分配。<ul>
<li>我国用户可向亚太网络信息中心APNIC(Asia Pacific Network Information Center)申请IP地址，需要缴费。</li>
<li>2011年2月3日，互联网号码分配管理局IANA (由ICANN行使职能）宣布，IPv4地址已经分配完毕。</li>
<li>我国在2014至2015年也逐步停止了向新用户和应用分配IPv4地址。同时全面开展商用部署IPv6。</li>
</ul>
</li>
<li>lPv4地址的编址方法经历了如下三个历史阶段:</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639364985794-0981b994-2016-4293-bbcf-26f1fefbc2b1.png">

<ul>
<li>32比特的IPv4地址不方便阅读、记录以及输入等，因此IPv4地址采用点分十进制表示方法以方便用户使用。<ul>
<li>即8比特为一组：00001010 11110000 00001111 10101010&#x3D;&gt;10.240.15.170</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639365222853-ce52e659-dc99-4c96-958e-fd45a96191d5.png">

<h3 id="2、分类编址的IPv4地址"><a href="#2、分类编址的IPv4地址" class="headerlink" title="2、分类编址的IPv4地址"></a>2、分类编址的IPv4地址</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639365332244-7da710e9-772f-4947-adc4-e273f9458771.png">

<ul>
<li>只有A类、B类和C类地址可分配给网络中的主机或路由器的各接口</li>
<li>主机号为<strong>“全0”</strong>的地址是网络地址，不能分配给主机或路由器的各接口</li>
<li>主机号为<strong>“全1”</strong>的地址是广播地址，不能分配给主机或路由器的各接口</li>
</ul>
<table>
<thead>
<tr>
<th>网络类型</th>
<th>第一个可指派的网络号</th>
<th>最后一个可指派的网络号</th>
<th>不能指派的网络号</th>
<th>占总地址空间</th>
<th>IP地址范围</th>
<th>网络数量及主机数量</th>
</tr>
</thead>
<tbody><tr>
<td>A类地址</td>
<td>1</td>
<td>126</td>
<td>0和127</td>
<td>1&#x2F;2</td>
<td>1.0.0.1~126.255.255.254</td>
<td>126（2^7-2）个，每个网络能容纳16,777,214（2^24-2）个主机</td>
</tr>
<tr>
<td>B类地址</td>
<td>128.0</td>
<td>191.255</td>
<td>无</td>
<td>1&#x2F;4</td>
<td>128.0.0.1~191.255.255.254</td>
<td>16384（2^14）个，每个网络能容纳65534（2^16-2）个主机</td>
</tr>
<tr>
<td>C类地址</td>
<td>192.0.0</td>
<td>223.255.255</td>
<td>无</td>
<td>1&#x2F;8</td>
<td>192.0.0.1~223.255.255.254</td>
<td>2097151（2^21-1）个，每个网络能容纳254（2^8-2）个主机</td>
</tr>
<tr>
<td>D类地址</td>
<td>多播地址</td>
<td></td>
<td></td>
<td>1&#x2F;16</td>
<td>224.0.0.1~239.255.255.254</td>
<td></td>
</tr>
<tr>
<td>E类地址</td>
<td>保留为今后使用</td>
<td></td>
<td></td>
<td>1&#x2F;16</td>
<td>240.0.0.1~255.255.255.254</td>
<td></td>
</tr>
</tbody></table>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639365762924-ab449f8e-6703-4cbb-93cc-726dbe48bc4b.png">

<h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639367428725-a99c88c5-cdaa-4d07-927b-0c9e5a54fb37.png">

<h3 id="3、划分子网的IPv4地址"><a href="#3、划分子网的IPv4地址" class="headerlink" title="3、划分子网的IPv4地址"></a>3、划分子网的IPv4地址</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639370131516-54ef8580-f31e-474c-a190-2ef03f9fac5d.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639370014270-2c1c1f79-d78c-4642-998a-b4c72b5a3340.png">

<h3 id="4、无分类编址的IPv4地址"><a href="#4、无分类编址的IPv4地址" class="headerlink" title="4、无分类编址的IPv4地址"></a>4、无分类编址的IPv4地址</h3><ul>
<li>划分子网在一定程度上缓解了因特网在发展中遇到的困难，但是数量巨大的C类网因为其地址空间太小并没有得到充分使用，而因特网的IP地址仍在加速消耗，整个IPv4地址空间面临全部耗尽的威胁。</li>
<li>为此，因特网工程任务组IETF又提出了采用无分类编址的方法来解决IP地址紧张的问题，同时还专门成立IPv6工作组负责研究新版本IP以彻底解决IP地址耗尽问题。</li>
<li>1993年，IETF发布了**无分类域间路由选择CIDR(**Classless Inter-Domain Routing)的RFC文档:RFC 1517~1519和1520。<ul>
<li>CIDR消除了传统的A类、B类和C类地址，以及划分子网的概念;</li>
<li>CIDR可以更加有效地分配IPv4的地址空间，并且可以在新的IPv6使用之前允许因特网的规模继续增长。</li>
</ul>
</li>
<li>CIDR使用“斜线记法”，或称CIDR记法。即在IPv4地址后面加上斜线“&#x2F;”，在斜线后面写上网络前缀所占的比特数量。</li>
<li>CIDR实际上是将网络前缀都相同的连续的IP地址组成一个“CIDR地址块”。我们只要知道CIDR地址块中的任何一个地址，就可以知道该地址块的全部细节。<ul>
<li>地址块的最小地址</li>
<li>地址块的最大地址</li>
<li>地址块中的地址数量</li>
<li>地址块聚合某类网络(A类、B类或C类)的数量</li>
<li>地址掩码（也可继续称为子网掩码)</li>
</ul>
</li>
</ul>
<h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639370616315-9d3768f4-1967-4f7e-abc5-4656e5c9f62f.png">

<h4 id="路由聚合（构造超网）"><a href="#路由聚合（构造超网）" class="headerlink" title="路由聚合（构造超网）"></a>路由聚合（构造超网）</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639370694734-eb2930cd-19a4-490e-ba7c-462d24c5fd7c.png">

<ul>
<li>网络前缀越长，地址块越小，路由越具体;</li>
<li>若路由器查表转发分组时发现有多条路由可选，则选择网络前缀最长的那条，这称为<strong>最长前缀匹配</strong>因为这样的路由更具体。</li>
</ul>
<h3 id="5、IPv4地址的应用规划"><a href="#5、IPv4地址的应用规划" class="headerlink" title="5、IPv4地址的应用规划"></a>5、IPv4地址的应用规划</h3><p><strong>定长的子网掩码FLSM(Fixed Length Subnet Mask)</strong></p>
<ul>
<li>使用同一个子网掩码来划分子网</li>
<li>每个子网所分配的IP地址数量相同，造成lP地址的浪费</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639371338342-5b063333-b4e7-41a8-8b6b-0aa600340fc1.png">
**变长的子网掩码VLSM(Variable Length Subnet Mask)**

<ul>
<li>使用不同的子网掩码来划分子网</li>
<li>每个子网所分配的IP地址数量可以不同，尽可能减少对IP地址的浪费</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639371528794-bd1a4bed-1c44-4005-8e08-dcf2cd07ea12.png">

<h2 id="（四）、IP数据报的发送和转发过程"><a href="#（四）、IP数据报的发送和转发过程" class="headerlink" title="（四）、IP数据报的发送和转发过程"></a>（四）、IP数据报的发送和转发过程</h2><p>为了将重点放在TCP&#x2F;IP协议栈的网际层发送和转发IP数据报的过程上，在之后的举例中，我们忽略使用ARP协议来获取目的主机或路由器接口的MAC地址的过程以及以太网交换机自学习和转发帧的过程。<br>IP数据报的发送和转发过程包含以下两部分:</p>
<ul>
<li><p><strong>主机发送IP数据报</strong></p>
<ul>
<li>判断目的主机是否与自己在同一个网络（判断方法请参看本节课相关示例)<ul>
<li>若在同一个网络，则属于直接交付;</li>
<li>若不在同一个网络，则属于间接交付，传输给主机所在网络的默认网关(路由器)，由默认网关帮忙转发;</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>路由器转发IP数据报</strong></p>
<ul>
<li>检查IP数据报首部是否出错:<ul>
<li>若出错，则直接丢弃该IP数据报并通告源主机;</li>
<li>若没有出错，则进行转发;</li>
</ul>
</li>
<li>根据IP数据报的目的地址在路由表中查找匹配的条目(查找方法请参看本节课相关示例)∶<ul>
<li>若找到匹配的条目，则转发给条目中指示的下一跳;</li>
<li>若找不到，则丢弃该IP数据报并通告源主机;</li>
</ul>
</li>
</ul>
</li>
<li><p>中继器和集线器工作在物理层，既不隔离冲突域也不隔离广播域。</p>
</li>
<li><p>网桥和交换机(多端口网桥)工作在数据链路层，可以隔离冲突域，不能隔离广播域。</p>
</li>
<li><p>路由器工作在网络层，既隔离冲突域，也隔离广播域。</p>
</li>
</ul>
<h2 id="（五）、静态路由配置"><a href="#（五）、静态路由配置" class="headerlink" title="（五）、静态路由配置"></a>（五）、静态路由配置</h2><ul>
<li>静态路由配置是指用户或网络管理员使用路由器的相关命令给路由器人工配置路由表。<ul>
<li>这种人工配置方式简单、开销小。但不能及时适应网络状态（流量、拓扑等）的变化。</li>
<li>一般只在小规模网络中采用。</li>
</ul>
</li>
<li>使用静态路由配置可能出现以下导致产生路由环路的错误<ul>
<li>配置错误</li>
<li>聚合了不存在的网络口</li>
<li>网络故障</li>
</ul>
</li>
<li>路由条目的类型<ul>
<li>直连网络</li>
<li>静态路由(人工配置)</li>
<li>动态路由(路由选择协议)</li>
</ul>
</li>
<li>特殊的静态路由条目  <ul>
<li>默认路由(目的网络为0.0.0.0，地址掩码为0.0.0.0)</li>
<li>特定主机路由（目的网络为特定主机的lP地址，地址掩码为255.255.255.255)</li>
<li>黑洞路由(下一跳为nullO)</li>
</ul>
</li>
</ul>
<h4 id="静态路由配置"><a href="#静态路由配置" class="headerlink" title="静态路由配置"></a>静态路由配置</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639373764004-2a5b0cc1-3d37-43c0-97a9-431863ff8f15.png">

<h4 id="默认路由、特定主机路由"><a href="#默认路由、特定主机路由" class="headerlink" title="默认路由、特定主机路由"></a>默认路由、特定主机路由</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639373924476-0304a1db-8a42-4b75-ada5-4d0fd2270fbc.png">

<h4 id="路由环路问题"><a href="#路由环路问题" class="headerlink" title="路由环路问题"></a>路由环路问题</h4><p>配置错误：<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639374100568-3deb4dbc-8ff8-45c3-bace-54a7031c3463.png"><br>聚合不存在网络：<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639374334656-af3201e5-8927-42de-a4cd-d174dd5bb2a5.png"><br>通过增加黑洞路由解决这一问题：<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639374176723-cfff04b7-a61b-408f-a166-a9fcf3cd85c3.png"><br>网络故障：<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639374227115-f0d48307-6e86-4699-ae67-79e04ef37439.png"><br>通过增加黑洞路由解决这一问题：<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639374679405-88cd117b-0707-4cca-bbd5-ee077c91efe7.png"></p>
<h2 id="（六）、路由选择协议"><a href="#（六）、路由选择协议" class="headerlink" title="（六）、路由选择协议"></a>（六）、路由选择协议</h2><h3 id="1、概述-4"><a href="#1、概述-4" class="headerlink" title="1、概述"></a>1、概述</h3><table>
<thead>
<tr>
<th>静态路由选择</th>
<th>动态路由选择</th>
</tr>
</thead>
<tbody><tr>
<td>由人工配置的网络路由、默认路由、特定主机路由、黑洞路由等都属于静态路由。</td>
<td>路由器通过路由选择协议自动获取路由信息。</td>
</tr>
<tr>
<td>这种人工配置方式简单、开销小。但不能及时适应网络状态(流量、拓扑等)的变化。</td>
<td>比较复杂、开销比较大。能较好地适应网络状态的变化。</td>
</tr>
<tr>
<td>一般只在小规模网络中采用。</td>
<td>适用于大规模网络。</td>
</tr>
</tbody></table>
<h4 id="因特网所采用的路由选择协议的主要特点"><a href="#因特网所采用的路由选择协议的主要特点" class="headerlink" title="因特网所采用的路由选择协议的主要特点"></a>因特网所采用的路由选择协议的主要特点</h4><pre><code>  1. 自适应
</code></pre>
<p>动态路由选择，能较好地适应网络状态的变化</p>
<pre><code>  2. 分布式
</code></pre>
<p>路由器之间交换路由信息</p>
<pre><code>  3. 分层次
</code></pre>
<p>将整个因特网划分为许多较小的自治系统AS(Autonomous System)</p>
<h4 id="因特网采用分层次的路由选择协议"><a href="#因特网采用分层次的路由选择协议" class="headerlink" title="因特网采用分层次的路由选择协议"></a>因特网采用分层次的路由选择协议</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639385462073-987d4136-c846-41e6-8f57-93826d29e914.png">

<h4 id="常见的路由选择协议"><a href="#常见的路由选择协议" class="headerlink" title="常见的路由选择协议"></a>常见的路由选择协议</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639385208909-e183209a-9fd6-4311-9b69-627b4f4271b4.png">

<h4 id="路由器的基本结构"><a href="#路由器的基本结构" class="headerlink" title="路由器的基本结构"></a>路由器的基本结构</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639385280686-9e5f99a9-d50a-4e91-95f1-bb2ab3aabc45.png">

<ul>
<li>路由表一般仅包含从目的网络到下一跳的映射</li>
<li>路由表需要对网络拓扑变化的计算最优化</li>
<li>转发表是从路由表得出的</li>
<li>转发表的结构应当使查找过程最优化</li>
</ul>
<h3 id="2、路由信息协议RIP的基本工作原理"><a href="#2、路由信息协议RIP的基本工作原理" class="headerlink" title="2、路由信息协议RIP的基本工作原理"></a>2、路由信息协议RIP的基本工作原理</h3><ul>
<li>路由信息协议RIP(Routing Information Protocol)是内部网关协议IGP中最先得到广泛使用的协议之一，其相关标准文档为RFC 1058。</li>
<li>RIP要求自治系统AS内的每一个路由器都要维护从它自己到AS内其他每一个网络的距离记录。这是一组距离，称为“距离向量D-V(Distance-Vector)” 。</li>
<li>RIP使用跳数(Hop Count)作为度量(Metric)来衡量到达目的网络的距离。<ul>
<li>路由器到直连网络的距离定义为1。</li>
<li>路由器到非直连网络的距离定义为所经过的路由器数加1。</li>
<li>允许一条路径最多只能包含15个路由器。“距离”等于16时相当于不可达。因此，RIP只适用于小型互联网。</li>
</ul>
</li>
<li>RIP认为好的路由就是“距离短”的路由，也就是所通过路由器数量最少的路由。当到达同一目的网络有多条“距离相等”的路由时，可以进行等价负载均衡。RIP包含以下三个要点:<ul>
<li>和谁交换信息	仅和相邻路由器交换信息</li>
<li>交换什么信息	自己的路由表</li>
<li>何时交换信息	周期性交换（例如每30秒)</li>
</ul>
</li>
</ul>
<h4 id="RIP的基本工作过程"><a href="#RIP的基本工作过程" class="headerlink" title="RIP的基本工作过程"></a>RIP的基本工作过程</h4><p>①路由器刚开始工作时，只知道自己到直连网络的距离为1。<br>②每个路由器仅和相邻路由器周期性地交换并更新路由信息。<br>③若干次交换和更新后，每个路由器都知道到达本AS内各网络的最短距离和下一跳地址，称为收敛。</p>
<h4 id="RIP的路由条目的更新规则"><a href="#RIP的路由条目的更新规则" class="headerlink" title="RIP的路由条目的更新规则"></a>RIP的路由条目的更新规则</h4><ul>
<li>发现了新的网络，添加</li>
<li>到达目的网络,不同下一跳，新路由优势，更新</li>
<li>到达目的网络,不同下一跳, 等价负载均衡</li>
<li>到达目的网络，相同下一跳，最新消息，更新</li>
<li>到达目的网络，不同下一跳，新路由劣势,不更新</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639386138042-f4e9bb33-70bd-49d5-8e15-27016865f30d.png">

<h4 id="RIP存在“坏消息传播得慢”的问题"><a href="#RIP存在“坏消息传播得慢”的问题" class="headerlink" title="RIP存在“坏消息传播得慢”的问题"></a>RIP存在“坏消息传播得慢”的问题</h4><ul>
<li>RIP存在“坏消息传播得慢”的问题</li>
<li>“坏消息传播得慢”又称为路由环路或距离无穷计数问题，这是距离向量算法的一个固有问题。可以采取多种措施减少出现该问题的概率或减小该问题带来的危害。<ul>
<li>限制最大路径距离为15 (16表示不可达)</li>
<li>当路由表发生变化时就立即发送更新报文(即“触发更新”），而不仅是周期性发送</li>
<li>让路由器记录收到某特定路由信息的接口，而不让同一路由信息再通过此接口向反方向传送(即“水平分割”)</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639386312360-562c7dd4-4eb7-4318-a7c3-b0d02f1ac7b8.png">

<h4 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639386502889-551f0c35-1ad7-4b52-8eea-d176cccd4f1e.png">

<h3 id="3、开放最短路径优先OSPF的基本工作原理"><a href="#3、开放最短路径优先OSPF的基本工作原理" class="headerlink" title="3、开放最短路径优先OSPF的基本工作原理"></a>3、开放最短路径优先OSPF的基本工作原理</h3><ul>
<li>开放最短路径优先OSPF(Open Shortest Path First)，是为克服RIP的缺点在1989年开发出来的。<ul>
<li>“开放”表明OSPF协议不是受某一家厂商控制，而是公开发表的。</li>
<li>“最短路径优先”是因为使用了Dijkstra提出的最短路径算法SPF。</li>
</ul>
</li>
<li>OSPF是基于链路状态的，而不像RIP那样是基于距离向量的。</li>
<li>OSPF采用SPF算法计算路由，从算法上保证了不会产生路由环路。</li>
<li>OSPF不限制网络规模，更新效率高，收敛速度快。</li>
<li>链路状态是指本路由器都和哪些路由器相邻，以及相应链路的“代价”(cost)。<ul>
<li>“代价”用来表示费用、距离、时延、带宽，等等。这些都由网络管理人员来决定。</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639386814287-b43c3ecc-b92e-4172-abfd-b02d32d1d5b9.png">

<ul>
<li>OSPF相邻路由器之间通过交互问候(Hello)分组，建立和维护邻居关系。<ul>
<li>Hello分组封装在IP数据报中，发往组播地址224.0.0.5;</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639386882320-0ab620de-8f37-43ea-8003-88d20cce0df8.png">

<ul>
<li>发送周期为10秒</li>
<li>40秒未收到来自邻居路由器的Hello分组，则认为该邻居路由器不可达。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639387763437-d5694431-09df-45cc-b4ec-0b5110edaa0c.png">

<ul>
<li>使用OSPF的每个路由器都会产生链路状态通告LSA(Link Siate Adverisemen)。LSA中包含以下内容:<ul>
<li>直连网络的链路状态信息</li>
<li>邻居路由器的链路状态信息</li>
</ul>
</li>
<li>LSA被封装在链路状态更新分组LSU中，采用洪泛法发送。</li>
<li>使用OSPF的每个路由器都有一个链路状态数据库LSDB，用于存储LSA。</li>
<li>通过各路由器洪泛发送封装有自己LSA的LSU分组，各路由器的LSDB最终将达到一致。</li>
<li>使用OSPF的各路由器基于LSDB进行最短路径优先SPF计算，构建出各自到达其他各路由器的最短路径，即构建各自的路由表。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639387891038-ed9784a3-78be-4ff4-82ff-2f135a3d720d.png">

<h4 id="OSPF有以下五种分组类型"><a href="#OSPF有以下五种分组类型" class="headerlink" title="OSPF有以下五种分组类型"></a>OSPF有以下五种分组类型</h4><ul>
<li>类型1，问候(Hello)分组</li>
</ul>
<p>用来发现和维护邻居路由器的可达性。</p>
<ul>
<li>类型2，数据库描述(Database Description)分组</li>
</ul>
<p>向邻居路由器给出自己的链路状态数据库中的所有链路状态项目的摘要信息</p>
<ul>
<li>类型3，链路状态请求(Link State Request)分组</li>
</ul>
<p>向邻居路由器请求发送某些链路状态项目的详细信息。</p>
<ul>
<li>类型4，链路状态更新(Link State Update)分组</li>
</ul>
<p>路由器使用这种分组将其链路状态进行洪泛发送，即用洪泛法对全网更新链路状态。</p>
<ul>
<li>类型5，链路状态确认(Link State Acknowledgment)分组</li>
</ul>
<p>这是对链路状态更新分组的确认分组。</p>
<h4 id="OSPF基本工作过程"><a href="#OSPF基本工作过程" class="headerlink" title="OSPF基本工作过程"></a>OSPF基本工作过程</h4><h4 id=""><a href="#" class="headerlink" title=""></a><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639387216916-5fdcc770-bca2-42d4-963e-dbe2ec62128d.png"></h4><p>OSPF在多点接入网络中路由器邻居关系的建立</p>
<ul>
<li>链路状态确认(Link State Acknowledgment)分组</li>
<li>选举指定路由器DR(designated router)和备用的指定路由器BDR(backup designated router)</li>
<li>所有的非DR&#x2F;BDR只与DR&#x2F;BDR建立邻居关系</li>
<li>非DR&#x2F;BDR之间通过DR&#x2F;BDR交换信息</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639388020466-de47f326-da91-457c-8d8d-3c07b5cc8153.png">

<h4 id="区域"><a href="#区域" class="headerlink" title="区域"></a>区域</h4><p>为了使OSPF能够用于规模很大的网络，OSPF把一个自治系统再划分为若千个更小的范围，叫做区域(Area)。<br>划分区域的好处就是把利用洪泛法交换链路状体信息的范围局限于每一个区域而不是整个自治系统，这就减少了整个网络上的通信量。</p>
<h2 id="（七）、边界网关协议BGP的基本工作原理"><a href="#（七）、边界网关协议BGP的基本工作原理" class="headerlink" title="（七）、边界网关协议BGP的基本工作原理"></a>（七）、边界网关协议BGP的基本工作原理</h2><h3 id="1、概述-5"><a href="#1、概述-5" class="headerlink" title="1、概述"></a>1、概述</h3><ul>
<li>内部网关协议IGP(例如路由信息协议RIP或开放最短路径优先OSPF)<ul>
<li>设法使分组在一个自治系统内尽可能有效地从源网络传输到目的网络</li>
<li>无需考虑自治系统外部其他方面的策略</li>
</ul>
</li>
<li>外部网关协议EGP(例如边界网关协议BGP)<ul>
<li>在不同自治系统内，度量路由的“代价”(距离，带宽，费用等)可能不同。因此，对于自治系统之间的路由选择，使用“代价”作为度量来寻找最佳路由是不行的。</li>
<li>自治系统之间的路由选择必须考虑相关策略(政治，经济，安全等)</li>
</ul>
</li>
</ul>
<h3 id="2、边界网关协议BGP"><a href="#2、边界网关协议BGP" class="headerlink" title="2、边界网关协议BGP"></a>2、边界网关协议BGP</h3><ul>
<li>BGP只能是力求寻找一条能够到达目的网络且比较好的路由（不能兜圈子)，而并非要寻找━条最佳路由</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639388341960-49177652-1408-4f6b-8369-288e8e265c7e.png">

<ul>
<li>在配置BGP时，每个自治系统的管理员要选择至少一个路由器作为该自治系统的“BGP发言人”</li>
<li>不同自治系统的BGP发言人要交换路由信息，首先必须建立TCP连接，端口号为179<ul>
<li>在此TCP连接上交换BGP报文以建立BGP会话</li>
<li>利用BGP会话交换路由信息（例如，增加新的路由，或撤销过时的路由，以及报告出错的情况等)</li>
<li>使用TCP连接交换路由信息的两个BGP发言人，彼此称为对方的邻站(neighbor）或对等站（peer)</li>
</ul>
</li>
<li>BGP发言人除了运行BGP外，还必须运行自己所在自治系统所使用的内部网关协议IGP，例如OSPF或RIP</li>
<li>BGP发言人交换网络可达性的信息（要到达某个网络所要经过的一系列自治系统)</li>
<li>当BGP发言人互相交换了网络可达性的信息后，各BGP发言人就根据所采用的策略从收到的路由信息中找出到达各自治系统的较好的路由。也就是构造出树形结构、不存在回路的自治系统连通图。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639388590672-857b72cd-8a13-4e68-9702-40d1ec1e3049.png">

<h3 id="3、BGP多级结构因特网"><a href="#3、BGP多级结构因特网" class="headerlink" title="3、BGP多级结构因特网"></a>3、BGP多级结构因特网</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639388639163-72e24525-8cca-4b6f-9f40-133349b43a76.png">

<h3 id="5、BGP-4有以下四种报文"><a href="#5、BGP-4有以下四种报文" class="headerlink" title="5、BGP-4有以下四种报文"></a>5、BGP-4有以下四种报文</h3><ul>
<li>OPEN(打开)报文:用来与相邻的另一个BGP发言人建立关系，使通信初始化。</li>
<li>UPDATE(更新)报文:用来通告某一路由的信息，以及列出要撤销的多条路由。</li>
<li>KEEPALIVE(保活)报文:用来周期性地证实邻站的连通性。</li>
<li>NOTIFICATION(通知)报文:用来发送检测到的差错。</li>
</ul>
<h3 id="6、练习"><a href="#6、练习" class="headerlink" title="6、练习"></a>6、练习</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639388966441-9c2145f8-d8e9-405e-9aa7-dedd94c7ba41.png">

<h2 id="（八）、IPv4数据报的首部格式"><a href="#（八）、IPv4数据报的首部格式" class="headerlink" title="（八）、IPv4数据报的首部格式"></a>（八）、IPv4数据报的首部格式</h2><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639389013659-8e034f9e-70d6-4434-8c9f-50739800b863.png">

<h4 id="版本："><a href="#版本：" class="headerlink" title="版本："></a>版本：</h4><p>占4比特，表示IP协议的版本。<br>通信双方使用的IP协议的版本必须一致。目前广泛使用的IP协议版本号为4(即lIPv4)</p>
<h4 id="首部长度："><a href="#首部长度：" class="headerlink" title="首部长度："></a>首部长度：</h4><p>占4比特，表示lP数据报首部的长度。该字段的取值以4字节为单位。<br>最小十进制取值为5，表示IP数据报首部只有20字节固定部分;<br>最大十进制取值为15，表示IP数据报首部包含20字节固定部分和最大40字节可变部分。</p>
<h4 id="可选字段："><a href="#可选字段：" class="headerlink" title="可选字段："></a>可选字段：</h4><p>长度从1个字节到40个字节不等。用来支持排错、测量及安全等措施。<br>可选字段增加了IP数据报的功能，但这同时也使得IP数据报的首部长度成为可变的。这就增加了每一个路由器处理P数据报的开销。实际上可选字段很少被使用.</p>
<h4 id="填充字段："><a href="#填充字段：" class="headerlink" title="填充字段："></a>填充字段：</h4><p>确保首部长度为4字节的整数倍。使用全0进行填充。</p>
<h4 id="区分服务："><a href="#区分服务：" class="headerlink" title="区分服务："></a>区分服务：</h4><p>占8比特，用来获得更好的服务。<br>1998年，因特网工程任务组IET把这个字段改名为区分服务。<br>利用该字段的不同数值可提供不同等级的服务质量。<br>只有在使用区分服务时，该字段才起作用。<br>一般情况下都不使用该字段。</p>
<h4 id="总长度："><a href="#总长度：" class="headerlink" title="总长度："></a>总长度：</h4><p>占16比特，表示IP数据报的总长度（首部+数据载荷)。<br>最大取值为十进制的65535，以字节为单位。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639389394038-5c3e652c-2927-47ca-b1cd-0a892f0f0049.png"></p>
<h4 id="标识："><a href="#标识：" class="headerlink" title="标识："></a>标识：</h4><p>占16比特，属于同一个数据报的各分片数据报应该具有相同的标识。IP软件维持一个计数器，每产生一个数据报，计数器值加1，并将此值赋给标识字段.</p>
<h4 id="标志："><a href="#标志：" class="headerlink" title="标志："></a>标志：</h4><p>占3比特，各比特含义如下:<br>（中间位）DF位:1表示不允许分片;0表示允许分片;<br>（最低位）MF位:1表示“后面还有分片”;0表示“这是最后一个分片”;<br>保留位:必须为0.</p>
<h4 id="片偏移："><a href="#片偏移：" class="headerlink" title="片偏移："></a>片偏移：</h4><p>占13比特，指出分片数据报的数据载荷部分偏移其在原数据报的位置有多少个单位。片偏移以8个字节为单位。<br>下图分片的MTU&#x3D;1420<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639389663657-5bddfe62-f630-4fcb-b4c0-cdc8eed02c03.png"></p>
<h4 id="生存时间："><a href="#生存时间：" class="headerlink" title="生存时间："></a>生存时间：</h4><p>TTL占8比特，表示IP数据报的生存时间。<br>最初以秒为单位，最大生存周期为255秒;路由器转发IP数据报时，将IP数据报首部中的该字段的值减去IP数据报在本路由器上所耗费的时间，若不为0就转发，否则就丢弃。<br>现在以“跳数”为单位，路由器转发IP数据报时，将IP数据报首部中的该字段的值减1，若不为0就转发，否则就丢弃。<br>IP数据报每经过一个路由器，路由器都要重新计算首部检验和，因为某些字段（生存时间、标志、片偏移等）的取值可能发生变化。</p>
<h4 id="协议："><a href="#协议：" class="headerlink" title="协议："></a>协议：</h4><p>占8比特，指明IPv4数据报的数据部分是何种协议数据单元。<br>常用的一些协议和相应的协议字段值如下：<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639389976732-400dc9f2-8b6f-4f18-b04b-11f12c6faa87.png"><br><strong>首部检验和：</strong><br>占16比特，用来检测首部在传输过程中是否出现差错。比CRC检验码简单，称为因特网检验和。<br>由于IP层本身并不提供可靠传输的服务，并且计算首部校验和是一项耗时的操作，因此在IPv6中，路由器不再计算首部校验和，从而更快转发IP数据报。<br><strong>源IP地址和目的IP地址：</strong><br>各占32比特，用来填写发送该IP数据报的源主机的IP地址和接收该IP数据报的目的主机的IP地址。</p>
<h3 id="练习-2"><a href="#练习-2" class="headerlink" title="练习"></a>练习</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639390211333-e5f13afe-12fb-41af-b983-cf9b97fe9135.png">
(1)Mac地址:00-21-27-21-51-ee
(2)IP分组经过路由器R时,生存时间字段被减1;首部检验和会被重新计算;若IP分组总长度大于MTU，则需要进行分片。
此时总长度字段、标志字段、片偏移字段都需要修改。

<h2 id="（九）、网际控制报文协议ICMP"><a href="#（九）、网际控制报文协议ICMP" class="headerlink" title="（九）、网际控制报文协议ICMP"></a>（九）、网际控制报文协议ICMP</h2><h3 id="1、ICMP差错报告报文共有以下五种"><a href="#1、ICMP差错报告报文共有以下五种" class="headerlink" title="1、ICMP差错报告报文共有以下五种:"></a>1、ICMP差错报告报文共有以下五种:</h3><h4 id="终点不可达"><a href="#终点不可达" class="headerlink" title="终点不可达"></a>终点不可达</h4><p>当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。具体可再根据ICMP的代码字段细分为目的网络不可达.目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种错误。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639390702074-c14ac883-4c78-4013-ac39-49379fcabd42.png"></p>
<h4 id="源点抑制"><a href="#源点抑制" class="headerlink" title="源点抑制"></a>源点抑制</h4><p>当路由器或主机由于拥塞而丢弃数据报时，就向源点发送源点抑制报文，使源点知道应当把数据报的发送速率放慢。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639390780012-7597a97d-6a30-417e-8bd9-8214df541a48.png"></p>
<h4 id="时间超过"><a href="#时间超过" class="headerlink" title="时间超过"></a>时间超过</h4><ul>
<li>当路由器收到一个目的IP地址不是自己的IP数据报，会将其生存时间TTL字段的值减1。</li>
</ul>
<p>若结果不为0，则将该IP数据报转发出去;若结果为O，除丢弃该IP数据报外，还要向源点发送时间超过报文。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639390836927-0353ddaf-8374-4b23-aff9-e433f77ae2d8.png"></p>
<ul>
<li>另外，当终点在预先规定的时间内不能收到一个数据报的全部数据报片时，就把已收到的数据报片都丢弃，也会向源点发送时间超过报文。</li>
</ul>
<h4 id="参数问题"><a href="#参数问题" class="headerlink" title="参数问题"></a>参数问题</h4><p>当路由器或目的主机收到IP数据报后，根据其首部中的检验和字段发现首部在传输过程中出现了误码，就丢弃该数据报，并向源点发送参数问题报文。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639390926241-e90a5c31-2267-4239-b858-252d6ede6f06.png"></p>
<h4 id="改变路由-重定向"><a href="#改变路由-重定向" class="headerlink" title="改变路由(重定向)"></a>改变路由(重定向)</h4><p>路由器把改变路由报文发送给主机，让主机知道下次应将数据报发送给另外的路由器（可通过更好的路由)。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639391137506-c2479138-4abb-4b07-a000-a0410ce05872.png"></p>
<h3 id="2、以下情况不应发送ICMP差错报告报文"><a href="#2、以下情况不应发送ICMP差错报告报文" class="headerlink" title="2、以下情况不应发送ICMP差错报告报文:"></a>2、以下情况不应发送ICMP差错报告报文:</h3><ul>
<li>对ICMP差错报告报文不再发送ICMP差错报告报文</li>
<li>对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文</li>
<li>对具有多播地址的数据报都不发送ICMP差错报告报文</li>
<li>对具有特殊地址(如127.0.0.0或0.0.0.0)的数据报不发送ICMP差错报告报文</li>
</ul>
<h3 id="3、常用的ICMP询问报文"><a href="#3、常用的ICMP询问报文" class="headerlink" title="3、常用的ICMP询问报文"></a>3、常用的ICMP询问报文</h3><p>常用的ICMP询问报文有以下两种:</p>
<h4 id="回送请求和回答"><a href="#回送请求和回答" class="headerlink" title="回送请求和回答"></a>回送请求和回答</h4><p>ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问。<br>收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文。<br>这种询问报文用来测试目的站是否可达及了解其有关状态。</p>
<h4 id="时间戳请求和回答"><a href="#时间戳请求和回答" class="headerlink" title="时间戳请求和回答"></a>时间戳请求和回答</h4><p>ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间。<br>在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从1900年1月1日起到当前时刻一共有多少秒。<br>这种询问报文用来进行时钟同步和测量时间。</p>
<h3 id="4、ICMP应用举例"><a href="#4、ICMP应用举例" class="headerlink" title="4、ICMP应用举例"></a>4、ICMP应用举例</h3><h4 id="分组网间探测PING-Packet-InterNet-Groper"><a href="#分组网间探测PING-Packet-InterNet-Groper" class="headerlink" title="分组网间探测PING(Packet InterNet Groper)"></a>分组网间探测PING(Packet InterNet Groper)</h4><ul>
<li>用来测试主机或路由器间的连通性</li>
<li>应用层直接使用网际层的ICMP(没有通过运输层的TCP或UDP)</li>
<li>使用ICMP回送请求和回答报文</li>
</ul>
<h4 id="跟踪路由traceroute"><a href="#跟踪路由traceroute" class="headerlink" title="跟踪路由traceroute"></a>跟踪路由traceroute</h4><ul>
<li>用来测试lP数据报从源主机到达目的主机要经过哪些路由器</li>
<li>Windows版本<ul>
<li>tracert命令</li>
<li>应用层直接使用网际层ICMP</li>
<li>使用了ICMP回送请求和回答报文以及差错报告报文</li>
</ul>
</li>
<li>Unix版本<ul>
<li>traceroute命令</li>
<li>在运输层使用UDP协议</li>
<li>仅使用ICMP差错报告报文</li>
</ul>
</li>
</ul>
<h2 id="（十）、虚拟专用网VPN与网络地址转换NAT"><a href="#（十）、虚拟专用网VPN与网络地址转换NAT" class="headerlink" title="（十）、虚拟专用网VPN与网络地址转换NAT"></a>（十）、虚拟专用网VPN与网络地址转换NAT</h2><h3 id="1、虚拟专用网VPN-Virtual-Private-Network"><a href="#1、虚拟专用网VPN-Virtual-Private-Network" class="headerlink" title="1、虚拟专用网VPN(Virtual Private Network)"></a>1、虚拟专用网VPN(Virtual Private Network)</h3><p>利用公用的因特网作为本机构各专用网之间的通信载体，这样的专用网又称为虚拟专用网。<br>由于IPv4地址的紧缺，一个机构能够申请到的IPv4地址数量往往远小于本机构所拥有的主机数量。因此，虚拟专用网中的各主机所分配的地址应该是本机构可自由分配的专用地址,而不是需要申请的、在因特网上使用的公有地址。</p>
<p>IP隧道技术：<br>如下图所示，同一机构内不同部门的内部网络所构成的虚拟专用网VPN又称为内联网VPN。<br>有时一个机构的VPN需要有某些外部机构（通常就是合作伙伴）参加进来。这样的VPN就称为外联网VPN。<br>在外地工作的员工需要访问公司内部的专用网络时，只要在任何地点接入到因特网，运行驻留在员工PC中的VPN软件，在员工的PC和公司的主机之间建立VPN隧道，即可访问专用网络中的资源。这种VPN称为远程接入VPN。</p>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639391737260-cbd098bc-6711-46c3-bc22-d7829679e73c.png">

<h3 id="2、网络地址转换NAT-Network-Address-Translation"><a href="#2、网络地址转换NAT-Network-Address-Translation" class="headerlink" title="2、网络地址转换NAT(Network Address Translation)"></a>2、网络地址转换NAT(Network Address Translation)</h3><p>虽然因特网采用了无分类编址方式来减缓IPv4地址空间耗尽的速度，但由于因特网用户数目的激增，特别是大量小型办公室网络和家庭网络接入因特网的需求不断增加，IPv4地址空间即将面临耗尽的危险仍然没有被解除。<br>1994年提出了一种网络地址转换NAT的方法再次缓解了IPv4地址空间即将耗尽的问题。<br>NAT能使大量使用内部专用地址的专用网络用户共享少量外部全球地址来访问因特网上的主机和资源。<br>不可以由外网主机主动与内网主机进行通信，对于一些P2P网络应用，需要外网主机主动与内网主机进行通信，在通过NAT时会遇到问题，需要网络应用自己使用一些特殊的NAT穿越技术来解决问题。<br>由于NAT对外网屏蔽了内网主机的网络地址，能为内网的主机提供一定的安全保护</p>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639392000959-e1fa7203-297d-4891-9521-e58c01b9bbf2.png">
该转换方法存在一个问题:如果NAT路由器具有N个全球IP地址，那么至多只能有N个内网主机能够同时和因特网上的主机通信。
=》
由于绝大多数的网络应用都是使用运输层协议TCP或UDP来传送数据，因此可以利用运输层的端口号和IP地址一起进行转换。
这样，用一个全球IP地址就可以使多个拥有本地地址的主机同时和因特网上的主机进行通信。这种将端口号和IP地址一起进行转换的技术叫作网络地址与端口号转换NAPT(Network Address and Port Translation)。
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639392128419-19be75e1-a174-4967-829b-9be590c2e4fc.png">


<h2 id="五、运输层"><a href="#五、运输层" class="headerlink" title="五、运输层"></a>五、运输层</h2><h2 id="（一）、概述-2"><a href="#（一）、概述-2" class="headerlink" title="（一）、概述"></a>（一）、概述</h2><h3 id="1、概述-6"><a href="#1、概述-6" class="headerlink" title="1、概述"></a>1、概述</h3><ul>
<li>之前课程所介绍的计算机网络体系结构中的物理层、数据链路层以及网络层它们共同解决了将主机通过异构网络互联起来所面临的问题，实现了主机到主机的通信。</li>
<li>但实际上在计算机网络中进行通信的真正实体是位于通信两端主机中的<strong>进程</strong>。</li>
<li>如何为运行在不同主机上的应用进程提供直接的通信服务是运输层的任务，运输层协议又称为端到端协议。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639471755026-f998ec0b-a9ed-43a7-bf6e-9a5a3d7a7b8b.png">


<h3 id="2、基本概念"><a href="#2、基本概念" class="headerlink" title="2、基本概念"></a>2、基本概念</h3><h4 id="运输层端口号"><a href="#运输层端口号" class="headerlink" title="运输层端口号"></a>运输层端口号</h4><ul>
<li>运行在计算机上的进程使用<strong>进程标识符PID</strong>来标志。</li>
<li>因特网上的计算机并不是使用统一的操作系统，不同的操作系统(windows，Linux，Mac OS)又使用<strong>不同格式的进程标识符</strong>。</li>
<li>为了使运行不同操作系统的计算机的应用进程之间能够进行网络通信，就必须使用统一的方法对TCP&#x2F;IP体系的应用进程进行标识。</li>
<li>TCP&#x2F;IP体系的运输层使用<strong>端口号</strong>来区分应用层的不同应用进程。<ul>
<li>端口号使用16比特表示，取值范围0~65535;<ul>
<li><strong>熟知端口号</strong>:0~1023，IANA把这些端口号指派给了TCP&#x2F;IP体系中最重要的一些应用协议，例如:FTP使用21&#x2F;20，HTTP使用80，DNS使用53。</li>
<li><strong>登记端口号</strong>:1024~49151，为没有熟知端口号的应用程序使用。使用这类端口号必须在IANA按照规定的手续登记，以防止重复。例如:Microsoft RDP微软远程桌面使用的端口是3389。</li>
<li><strong>短暂端口号</strong>:49152~65535，留给客户进程选择暂时使用。当服务器进程收到客户进程的报文时，就知道了客户进程所使用的动态端口号。通信结束后，这个端口号可供其他客户进程以后使用。</li>
</ul>
</li>
<li>端口号只具有本地意义，即端口号只是为了标识本计算机应用层中的各进程，在因特网中，不同计算机中的相同端口号是没有联系的。</li>
</ul>
</li>
</ul>
<h4 id="发送方的复用和接收方的分用"><a href="#发送方的复用和接收方的分用" class="headerlink" title="发送方的复用和接收方的分用"></a>发送方的复用和接收方的分用</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472102117-f3b26d04-fa6f-4273-8186-ba71a6dfcaa3.png">

<h4 id="TCP-x2F-IP体系的应用层常用协议所使用的运输层熟知端口号"><a href="#TCP-x2F-IP体系的应用层常用协议所使用的运输层熟知端口号" class="headerlink" title="TCP&#x2F;IP体系的应用层常用协议所使用的运输层熟知端口号"></a>TCP&#x2F;IP体系的应用层常用协议所使用的运输层熟知端口号</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472139816-b8c39d13-0ee0-4981-a229-011d7b597293.png">

<h2 id="（二）、UDP、TCP"><a href="#（二）、UDP、TCP" class="headerlink" title="（二）、UDP、TCP"></a>（二）、UDP、TCP</h2><h3 id="1、UDP与TCP对比"><a href="#1、UDP与TCP对比" class="headerlink" title="1、UDP与TCP对比"></a>1、UDP与TCP对比</h3><p>UDP和TCP是TCP&#x2F;IP体系结构运输层中的两个重要协议</p>
<table>
<thead>
<tr>
<th><strong>UDP</strong></th>
<th><strong>TCP</strong></th>
</tr>
</thead>
<tbody><tr>
<td>无连接</td>
<td>面向连接</td>
</tr>
<tr>
<td>支持一对一，一对多，多对一和多对多交互通信。</td>
<td></td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472921900-15c5ee0b-c06a-461a-99e8-f9c4abefca06.png"></td>
<td>每一条TCP连接只能有两个端点EP，只能是一对一通信。</td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472935455-47f310bf-ee0d-4a77-8c8a-a7133cf989b8.png"></td>
<td></td>
</tr>
<tr>
<td>对应用层交付的报文直接打包</td>
<td></td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472867343-10a96437-9719-45c0-87d6-7761803df1cf.png"></td>
<td>面向字节流</td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472885675-7b8beee8-8ea5-4aa5-a930-01c45b293902.png">（全双工）</td>
<td></td>
</tr>
<tr>
<td>尽最大努力交付，也就是不可靠;不使用流量控制和拥塞控制。</td>
<td></td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472828125-d10c7b97-75fc-45b5-bbc7-12b90d962ab3.png"></td>
<td>可靠传输，使用流量控制和拥塞控制。</td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472845115-88e9ab9a-8d9e-44aa-b712-7042aa49b31b.png"></td>
<td></td>
</tr>
<tr>
<td>首部开销小，仅8字节</td>
<td></td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472758513-4407d4ae-e0a3-4ea0-ba80-6ededb7932a1.png"></td>
<td>首部最小20字节，最大60字节</td>
</tr>
<tr>
<td><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639472774784-d63a38da-0d14-4dc9-a97f-96c760f1aca9.png"></td>
<td></td>
</tr>
</tbody></table>
<h3 id="2、TCP的流量控制"><a href="#2、TCP的流量控制" class="headerlink" title="2、TCP的流量控制"></a>2、TCP的流量控制</h3><ul>
<li>一般来说，我们总是希望数据传输得更快一些。但如果发送方把数据发送得过快，接收方就可能来不及接收，这就会造成数据的丢失。</li>
<li>所谓**流量控制(flow control)**就是让发送方的发送速率不要太快，要让接收方来得及接收。<ul>
<li>利用<strong>滑动窗口机制</strong>可以很方便地在TCP连接上实现对发送方的流量控制。<ul>
<li>TCP接收方利用自己的<strong>接收窗口</strong>的大小来限制发送方<strong>发送窗口</strong>的大小。</li>
<li>TCP发送方收到接收方的<strong>零窗口通知</strong>后，应启动<strong>持续计时器</strong>。持续计时器超时后，向接收方发送<strong>零窗口探测报文</strong>。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="流量工作工作流程"><a href="#流量工作工作流程" class="headerlink" title="流量工作工作流程"></a>流量工作工作流程</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639473258356-d3241f08-f53b-46c2-a08b-07fb1295487a.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639473319600-c9836eda-c60c-4f7e-a238-c5b7b287e46e.png">

<h4 id="练习-3"><a href="#练习-3" class="headerlink" title="练习"></a>练习</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639473417055-5ff7ba0c-0210-4160-bd3f-e942d623c1f4.png">

<h3 id="3、TCP的拥塞控制"><a href="#3、TCP的拥塞控制" class="headerlink" title="3、TCP的拥塞控制"></a>3、TCP的拥塞控制</h3><ul>
<li>在某段时间，若对网络中某一资源的需求超过了该资源所能提供的可用部分，网络性能就要变坏。这种情况就叫做**拥塞(congestion)**。<ul>
<li>在计算机网络中的链路容量（即带宽)、交换结点中的缓存和处理机等，都是网络的资源。</li>
</ul>
</li>
<li>若出现拥塞而不进行控制，整个网络的吞吐量将随输入负荷的增大而下降。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639473771530-1bbb00a7-54bc-4e3d-beb0-2f614f6216d5.png">
**拥塞控制主要是四个算法：慢启动（慢开始slow-start）、拥塞避免（congestion avoidance）、快速重传（快重传fast retransmit）、快速恢复（快恢复fast recovery）**

<blockquote>
<p>参考：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41501074/article/details/110941340">https://blog.csdn.net/weixin_41501074&#x2F;article&#x2F;details&#x2F;110941340</a><br><a target="_blank" rel="noopener" href="https://www.it610.com/article/1293851513923379200.htm">https://www.it610.com/article/1293851513923379200.htm</a></p>
</blockquote>
<h4 id="慢启动"><a href="#慢启动" class="headerlink" title="慢启动"></a>慢启动</h4><blockquote>
<p>发送方维护一个叫做<strong>拥塞窗口cwnd</strong>的状态变量，其值取决于网络的拥塞程度，并且<strong>动态变化</strong>。</p>
<ul>
<li>拥塞窗口cwnd的维护原则:只要网络没有出现拥塞，拥塞窗口就再增大 ;但只要网络出现拥塞，拥塞窗口就减少一些。</li>
<li>判断出现网络拥塞的依据:没有按时收到应当到达的确认报文（即<strong>发生超时重传</strong>)。</li>
</ul>
<p>发送方将拥塞窗口作为发送窗口swnd，即swnd &#x3D; cwnd。</p>
<p>维护一个叫慢启动门限 <strong>ssthresh （slow start threshold）</strong>状态变量。</p>
<ul>
<li><strong>当 cwnd &lt; ssthresh 时，使用慢启动算法。</strong></li>
<li><strong>当 cwnd &gt;ssthresh 时，就会使用「拥塞避免算法」。</strong></li>
<li><strong>当 cwnd &gt;ssthresh 时，既可使用慢启动算法，也可使用「拥塞避免算法」。</strong></li>
</ul>
</blockquote>
<p>TCP 在刚建立连接完成后，首先是有个慢启动的过程，这个慢启动的意思就是一点一点的提高发送数据包的数量。<br>慢启动的算法记住一个规则就行：当发送方每收到一个 ACK，拥塞窗口 cwnd 的大小就会加 1。<br>这里假定拥塞窗口 cwnd 和发送窗口 swnd 相等，下面举个例子：</p>
<ul>
<li>连接建立完成后，一开始初始化 cwnd &#x3D; 1，表示可以传一个 MSS 大小的数据。</li>
<li>当收到一个 ACK 确认应答后，cwnd 增加 1，于是一次能够发送 2 个</li>
<li>当收到 2 个的 ACK 确认应答后， cwnd 增加 2，于是就可以比之前多发2 个，所以这一次能够发送 4 个</li>
<li>当这 4 个的 ACK 确认到来的时候，每个确认 cwnd 增加 1， 4 个确认 cwnd 增加 4，于是就可以比之前多发 4 个，所以这一次能够发送 8 个。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637594657237-9d2ff2f8-ebfb-45c3-8d9c-aac2fa615962.png">
可以看出慢启动算法，发包的个数是指数性的增长。


<h4 id="拥塞避免算法"><a href="#拥塞避免算法" class="headerlink" title="拥塞避免算法"></a>拥塞避免算法</h4><p>前面说道，当拥塞窗口 cwnd <strong>「超过」慢启动门限 ssthresh <strong>就会进入拥塞避免算法。<br>那么进入拥塞避免算法后，它的规则是：每当收到一个 ACK 时，cwnd 增加 1&#x2F;cwnd（也就是</strong>每轮次加1，线性增长</strong>）。</p>
<p>接上前面的慢启动的例子，现假定 ssthresh 为 8：</p>
<ul>
<li>当 8 个 ACK 应答确认到来时，每个确认增加 1&#x2F;8，8 个 ACK 确认 cwnd 一共增加 1，于是这一次能够发送 9 个 MSS 大小的数据，变成了线性增长。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637594695726-07531592-f203-4a34-bf09-4c89975670c7.png">
**--当重传计时器超时，判断网络很可能出现了拥塞**，触发**超时重传**:
当发生了「超时重传」，则就会使用拥塞发生算法。
这个时候，sshresh 和 cwnd 的值会发生变化：

<ul>
<li><strong>ssthresh 设为 cwnd&#x2F;2，</strong></li>
<li><strong>cwnd 重置为 1，并重新开始慢开始算法</strong></li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637594746529-0589cc72-01ec-4e1f-ac08-46621dae73e7.png">
接着，就重新开始慢启动，慢启动是会突然减少数据流的。这真是一旦「超时重传」，马上回到解放前。但是这种方式太激进了，反应也很强烈，会造成网络卡顿。

<h4 id="快速重传"><a href="#快速重传" class="headerlink" title="快速重传"></a>快速重传</h4><ul>
<li>1990年又增加了两个新的拥塞控制算法(改进TCP的性能)，这就是快重传和快恢复（TCP Reno版本)。<ul>
<li>有时，个别报文段会在网络中丢失，但实际上网络并未发生拥塞。这将导致发送方超时重传，并误认为网络发生了拥塞;<ul>
<li>发送方把拥塞窗口cwnd又设置为最小值1，并错误地启动慢开始算法，因而降低了传输效率。</li>
<li>采用快重传算法可以让发送方尽早知道发生了个别报文段的丢失。</li>
</ul>
</li>
</ul>
</li>
<li>所谓快重传，就是使发送方尽快进行重传，而不是等超时重传计时器超时再重传。<ul>
<li>要求接收方不要等待自己发送数据时才进行捎带确认，而是要立即发送确认;</li>
<li>即使收到了失序的报文段也要立即发出对已收到的报文段的重复确认。</li>
<li>发送方一<strong>旦收到3个连续的重复确认</strong>，就将相应的报文段<strong>立即重传</strong>，而不是等该报文段的超时重传计时器超时再重传。</li>
<li>对于个别丢失的报文段，发送方不会出现超时重传，也就不会误认为出现了拥塞（进而降低拥塞窗口cwnd为1)。使用快重传可以使整个网络的吞吐量提高约20%。</li>
</ul>
</li>
</ul>
<p><strong>快速重传 ssthresh 和 cwnd 变化如下</strong>：</p>
<ul>
<li><strong>cwnd &#x3D; cwnd&#x2F;2 ，也就是设置为原来的一半;</strong></li>
<li><strong>ssthresh &#x3D; cwnd;</strong></li>
<li><strong>进入快速恢复算法</strong></li>
</ul>
<h4 id="快速恢复"><a href="#快速恢复" class="headerlink" title="快速恢复"></a>快速恢复</h4><p>后来的“快速恢复”算法是在上述的“快速重传”算法后添加的，当收到3个重复ACK时，TCP最后进入的不是拥塞避免阶段，而是快速恢复阶段。<br>快速重传和快速恢复算法一般同时使用，快速恢复算法是认为，你还能收到 3 个重复 ACK 说明网络也不那么糟糕，所以没有必要像 RTO 超时那么强烈。<br>然后，进入快速恢复算法如下：</p>
<ul>
<li><strong>cwnd &#x3D; cwnd&#x2F;2 ，也就是设置为原来的一半;</strong></li>
<li><strong>ssthresh &#x3D; cwnd;（</strong>进入快速恢复之前，cwnd 和 ssthresh 已被更新了，这里的两步和快速重传的相同步骤执行一次即可<strong>）</strong></li>
<li><strong>拥塞窗口 cwnd &#x3D; ssthresh  （有的版本是cwnd &#x3D; ssthresh + 3，+ 3 的意思是确认有 3 个数据包被收到了）</strong></li>
<li>重传丢失的数据包</li>
<li>如果再收到重复的 ACK，那么 cwnd 增加 1</li>
<li>如果收到新数据的 ACK 后，设置 cwnd 为 ssthresh，接着就进入了拥塞避免算法</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1637594851075-18d2b406-a8e6-4b08-8940-8f432d0a61a2.png">


<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639475569138-0e1e2151-822c-4486-91f0-67065819422e.png">

<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><ul>
<li>“慢开始”是指一开始向网络注入的报文段少，并不是指拥塞窗口cwnd增长速度慢;</li>
<li>“拥塞避免”并非指完全能够避免拥塞，而是指在拥塞避免阶段将拥塞窗口控制为按线性规律增长，使网络比较不容易</li>
</ul>
<h3 id="4、TCP超时重传"><a href="#4、TCP超时重传" class="headerlink" title="4、TCP超时重传"></a>4、TCP超时重传</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639476630549-3b64d5fe-1230-49fb-85b3-5731e5a016db.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639476738957-7abbdc49-a3bd-4b1a-b8d6-ee663e5d4411.png">

<ul>
<li>针对<strong>出现超时重传时无法测准往返时间RTT</strong>的问题，<strong>Karn</strong>提出了一个算法:在计算加权平均往返时间RTTs时，只要报文段重传了，就不采用其往返时间RTT样本。也就是出现重传时，不重新计算RTTs，进而超时重传时间RTO也不会重新计算。<ul>
<li>这又引起了新的问题。设想出现这样的情况:报文段的时延突然增大了很多，并且之后很长一段时间都会保持这种时延。因此在原来得出的重传时间内，不会收到确认报文段。于是就重传报文段。但根据Karn算法，不考虑重传的报文段的往返时间样本。这样，超时重传时间就无法更新。这会导致报文段反复被重传。</li>
</ul>
</li>
<li>因此，要对<strong>Karn算法进行修正</strong>。方法是:报文段每重传一次，就把超时重传时间RTO增大一些。典型的做法<strong>是将新RTO的值取为旧RTO值的2倍</strong>。</li>
</ul>
<h4 id="计算超时重传时间RTO"><a href="#计算超时重传时间RTO" class="headerlink" title="计算超时重传时间RTO"></a>计算超时重传时间RTO</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639476941759-2f71ffa2-f0fc-4731-b14d-75dbbdba691a.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639477028607-d3726058-5d41-4f4b-a155-e99cea2b1551.png">

<h3 id="5、TCP可靠传输"><a href="#5、TCP可靠传输" class="headerlink" title="5、TCP可靠传输"></a>5、TCP可靠传输</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639478119285-8d22f6f7-593b-4361-a76c-42941d0834c0.png">
发送方ack，确认收到31号的ack携带序号是32；未收到31号，返回确认ack31

<h4 id="TCP基于以字节为单位的滑动窗口来实现可靠传输。"><a href="#TCP基于以字节为单位的滑动窗口来实现可靠传输。" class="headerlink" title="TCP基于以字节为单位的滑动窗口来实现可靠传输。"></a>TCP基于以字节为单位的滑动窗口来实现可靠传输。</h4><p>发送方在未收到接收方的确认时，可将发送窗口内还未发送的数据全部发送出去;<br>接收方只接收序号落入发送窗口内的数据;</p>
<h4 id="虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收方的接收窗口一样大。"><a href="#虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收方的接收窗口一样大。" class="headerlink" title="虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收方的接收窗口一样大。"></a>虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收方的接收窗口一样大。</h4><p>网络传送窗口值需要经历一定的时间滞后，并且这个时间还是不确定的。<br>发送方还可能根据网络当时的拥塞情况适当减小自己的发送窗口尺寸。</p>
<h4 id="对于不按序到达的数据应如何处理，TCP并无明确规定。"><a href="#对于不按序到达的数据应如何处理，TCP并无明确规定。" class="headerlink" title="对于不按序到达的数据应如何处理，TCP并无明确规定。"></a>对于不按序到达的数据应如何处理，TCP并无明确规定。</h4><p>如果接收方把不按序到达的数据一律丢弃，那么接收窗口的管理将会比较简单，但这样做对网络资源的利用不利，因为发送方会重复传送较多的数据。<br>TCP通常对不按序到达的数据是先临时存放在接收窗口中，等到字节流中所缺少的字节收到后，再按序交付上层的应用进程。</p>
<h4 id="TCP要求接收方必须有累积确认和捎带确认机制，这样可以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便捎带上。"><a href="#TCP要求接收方必须有累积确认和捎带确认机制，这样可以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便捎带上。" class="headerlink" title="TCP要求接收方必须有累积确认和捎带确认机制，这样可以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便捎带上。"></a>TCP要求接收方必须有累积确认和捎带确认机制，这样可以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便捎带上。</h4><p>接收方不应过分推迟发送确认，否则会导致发送方不必要的超时重传，这反而浪费了网络的资源。<br>TCP标准规定，确认推迟的时间不应超过0.5秒。若收到一连串具有最大长度的报文段，则必须每隔一个报文段就发送一个确认[RFC 1122].<br>捎带确认实际上并不经常发生，因为大多数应用程序很少同时在两个方向上发送数据。</p>
<h4 id="TCP的通信是全双工通信。通信中的每一方都在发送和接收报文段。"><a href="#TCP的通信是全双工通信。通信中的每一方都在发送和接收报文段。" class="headerlink" title="TCP的通信是全双工通信。通信中的每一方都在发送和接收报文段。"></a>TCP的通信是全双工通信。通信中的每一方都在发送和接收报文段。</h4><p>因此，每一方都有自己的发送窗口和接收窗口。在谈到这些窗口时，一定要弄清楚是哪一方的窗口。</p>
<h3 id="6、TCP的运输连接管理"><a href="#6、TCP的运输连接管理" class="headerlink" title="6、TCP的运输连接管理"></a>6、TCP的运输连接管理</h3><ul>
<li>TCP是面向连接的协议，它基于运输连接来传送TCP报文段。</li>
<li>TCP运输连接的建立和释放是每一次面向连接的通信中必不可少的过程。</li>
<li>TCP运输连接有以下三个阶段:<ul>
<li><strong>建立TCP连接</strong></li>
<li><strong>数据传送</strong></li>
<li><strong>释放TCP连接</strong></li>
</ul>
</li>
</ul>
<p>TCP的运输连接管理就是使运输连接的建立和释放都能正常地进行。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639478412845-78ec4e11-b6e4-4e3d-9529-8073e27ee653.png"></p>
<h4 id="三报文握手"><a href="#三报文握手" class="headerlink" title="三报文握手"></a>三报文握手</h4><ul>
<li>TCP的连接建立要解决以下三个问题:</li>
</ul>
<p>①使TCP双方能够确知对方的存在;<br>②使TCP双方能够协商一些参数（如最大窗口值、是否使用窗口扩大选项和时间戳选项以及服务质量等);<br>③使TCP双方能够对运输实体资源（(如缓存大小、连接表中的项目等）进行分配。</p>
<ul>
<li>TCP使用“三报文握手”建立连接<ul>
<li>一握手（TCP连接请求报文）</li>
</ul>
</li>
</ul>
<p>SYN同步位：表明这是一个TCP连接请求报文段。<br>seq：TCP客户进程所选择的初始序号。</p>
<ul>
<li>二握手（TCP连接请求确认报文）</li>
</ul>
<p>SYN&#x3D;1，ACK&#x3D;1：表明这是一个TCP连接请求确认报文段。<br>序号字段seq被设置了一个初始值y：作为TCP服务器进程选择的初始序号。<br>确认号字段ack的值被设置成了x+1：这是对TCP客户进程选择的初始序号的确认。</p>
<ul>
<li>三握手（普通的TCP确认报文）</li>
</ul>
<p>确认位ACK被设置为1：表明这是一个普通的TCP确认报文段。<br>seq&#x3D;x+1，这是因为TCP客户进程发送的第一个TP报文段的序号为x。（发送的下一份TCP报文序号任然是x+1）<br>ack&#x3D;y，这是对TCP服务器进程选择的初始序号的确认。<br>注意：<br>TCP规定SYN被设置为1的报文段不能携带数据,但要消耗掉一个序号。<br>TCP规定普通的TCP确认报文段回以携带数据，但如果不携带数据。则不消耗序号。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639478294745-ac2c51a4-5ff6-48d5-a981-ad6446428186.png"><br>不多余!这是为了防止已失效的连接请求报文段突然又传送到了TCP服务器，因而导致错误。</p>
<h4 id="四报文挥手"><a href="#四报文挥手" class="headerlink" title="四报文挥手"></a>四报文挥手</h4><ul>
<li>一挥手(TCP连接释放报文)<ul>
<li>终止位FIN、确认位ACK设置为1：表明这是一个TCP连接释放报文段，同时也是对之前接收数据的确认。</li>
<li>序号seq字段的值设置为u：u等于TCP客户进程之前<strong>已传送过</strong>的数据的最后一个字节的序号加1。</li>
<li>确认号ack字段的值设置为v：等于TCP客户进程之前<strong>已收到的</strong>数据的最后一个字节的序号加1。</li>
</ul>
</li>
<li>二挥手(普通的TCP确认报文)<ul>
<li>确认位ACK被设置为1：表明这是一个普通的TCP确认报文段。</li>
<li>seq&#x3D;v，等于TCP客户进程之前<strong>已收到的</strong>数据的最后一个字节的序号加1。（发送的下一份TCP报文序号任然是v）</li>
<li>ack&#x3D;u+1，这是对TCP连接释放报文段的确认。</li>
</ul>
</li>
<li>三挥手(TCP连接释放报文段，最后确认状态)<ul>
<li>终止位AN和确认位ACK的值都被变置为1：表明放是—个TCP连接释放报文段，同时也对之前收到的报文段进行确认。</li>
<li>序号seq字段的值为v：在半关闭状态下，TCP进程可能发送一些数据，导致序列号增加；如果没有发送数据则w&#x3D;v</li>
<li>确认号adk字段的值为u+1:这是对之前收到的TGP连接释放报文段的重复确认。</li>
</ul>
</li>
<li>四挥手(普通的TCP确认报文)<ul>
<li>确认位ACK被设置为1：表明这是一个普通的TCP确认报文段。</li>
<li>seq&#x3D;u+1，等于TCP客户进程之前<strong>已收到的</strong>数据的最后一个字节的序号加1。</li>
<li>ack&#x3D;w+1，这是对TCP连接释放报文段的确认。</li>
</ul>
</li>
</ul>
<p>注意：<br>TCP规定终止位N等于1的报文段即使不携带数据,但要消耗掉一个序号。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639479923899-6fbe3d74-173c-41c1-8617-33e8e9a69387.png"><br>时间等待是为了避免以下这种情况<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639481132265-5e677d4f-3b99-4393-af71-c98da4a727e0.png"><br>保活计时器<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639481170726-9462c4db-22f4-4928-a955-406f3dcbaa16.png"></p>
<h3 id="7、TCP报文首部格式"><a href="#7、TCP报文首部格式" class="headerlink" title="7、TCP报文首部格式"></a>7、TCP报文首部格式</h3><ul>
<li>为了实现可靠传输，TCP采用了面向字节流的方式。</li>
<li>但TCP在发送数据时，是从发送缓存取出一部分或全部字节并给其添加一个首部使之成为TCP报文段后进行发送。<ul>
<li>一个TCP报文段由首部和数据载荷两部分构成;</li>
<li>TCP的全部功能都体现在它首部中各字段的作用。</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639481228959-92c42af2-573e-46d8-b132-95d4281df880.png">
**源端口 **:占16比特，写入源端口号，用来标识发送该TCP报文段的应用进程。
**目的端口 **:占16比特，写入目的端口号，用来标识接收该TCP报文段的应用进程。
**序号 **:占32比特，取值范围[0，2^32-1]，序号增加到最后一个后，下一个序号就又回到0。
指出本TCP报文段数据载荷的第一个字节的序号。
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639482205064-4dda84cf-caff-40a3-9dab-4600593108ee.png">
**确认号 **:占32比特，取值范围[0,2^32-1]，确认号增加到最后一个后，下一个确认号就又回到0。
指出期望收到对方下一个TCP报文段的数据载荷的第一个字节的序号，同时也是对之前收到的所有数据的确认。
若确认号=n，则表明到序号n-1为止的所有数据都已正确接收，期望接收序号为n的数据。
**确认标志位ACK **:取值为1时确认号字段才有效;取值为0时确认号字段无效。
TCP规定，在连接建立后所有传送的TCP报文段都必须把ACK置1。
**数据偏移 **:占4比特，并以4字节为单位。
用来指出TCP报文段的数据载荷部分的起始处距离TCP报文段的起始处有多远。
这个字段实际上是指出了TCP报文段的首部长度。
首部固定长度为20字节，因此数据偏移字段的最小值为$(0101)_2$
首部最大长度为60字节，因此数据偏移字段的最小值为$(1111)_2$
**保留 **:占6比特，保留为今后使用，但目前应置为0。
**窗口 **:占16比特，以字节为单位。指出发送本报文段的一方的接收窗口。
窗口值作为接收方让发送方设置其发送窗口的依据。
这是以接收方的接收能力来控制发送方的发送能力，称为**流量控制**。
**校验和 **:占16比特，检查范围包括TCP报文段的首部和数据载荷两部分。
在计算校验和时，要在TCP报文段的前面加上12字节的伪首部。
**同步标志位SYN **:在TCP连接建立时用来同步序号。
**终止标志位FIN **:用来释放TCP连接。
**复位标志位RST **:用来复位TCP连接。
当RST=1时，表明TCP连接出现了异常，必须释放连接，然后再重新建立连接。
RST置1还用来拒绝一个非法的报文段或拒绝打开一个TCP连接。
**推送标志位PSH **:接收方的TCP收到该标志位为1的报文段会尽快上交应用进程，而不必等到接收缓存都填满后再向上交付。
**紧急标志位URG **:取值为1时紧急指针字段有效;取值为0时紧急指针字段无效。
**紧急指针 **:占16比特，以字节为单位，用来指明紧急数据的长度。
当发送方有紧急数据时，可将紧急数据插队到发送缓存的最前面，并立刻封装到一个TCP报文段中进行发送。紧急指针会指出本报文段数据载荷部分包含了多长的紧急数据，紧急数据之后是普通数据。
**选项（长度可变)：**
最大报文段长度MSS选项:TCP报文段数据载荷部分的最大长度。窗口扩大选项:为了扩大窗口(提高吞吐率)。
时间戳选项:
用来计算往返时间RTT
用于处理序号超范围的情况，又称为防止序号绕回PAWS。
选择确认选项：用来实现选择确认功能
**填充 **:由于选项的长度可变，因此使用填充来确保报文段首部能被4整除(因为数据偏移字段，也就是首部长度字段，是以4字节为单位的)。

<h1 id="六、应用层"><a href="#六、应用层" class="headerlink" title="六、应用层"></a>六、应用层</h1><h3 id="（一）、概述-3"><a href="#（一）、概述-3" class="headerlink" title="（一）、概述"></a>（一）、概述</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639483024590-8ba88064-2666-477b-8a69-7925982209c7.png">

<h3 id="（二）、客户端-服务器方式和对等方式"><a href="#（二）、客户端-服务器方式和对等方式" class="headerlink" title="（二）、客户端-服务器方式和对等方式"></a>（二）、客户端-服务器方式和对等方式</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639483250072-cf1b70c0-dd04-494d-899b-35df0f612219.png">

<h3 id="（三）、动态主机配置协议DHCP"><a href="#（三）、动态主机配置协议DHCP" class="headerlink" title="（三）、动态主机配置协议DHCP"></a>（三）、动态主机配置协议DHCP</h3><ul>
<li>动态主机配置协议DHCP(Dynamic Host Configuration Protocol)提供了一种机制，称为即插即用连网。这种机制允许一台计算机加入新网络时可自动获取IP地址等网络配置信息而不用手工参与。</li>
<li>DHCP主要使用以下报文来实现其功能:<ul>
<li>DHCP DISCOVER: DHCP发现报文</li>
<li>DHCP OFFER: DHCP提供报文</li>
<li>DHCP REQUEST: DHCP请求报文</li>
<li>DHCP ACK: DHCP确认报文</li>
<li>DHCP NACK: DHCP否认报文</li>
<li>DHCP RELEASE: DHCP释放报文</li>
</ul>
</li>
<li>DHCP报文在运输层使用UDP协议封装<ul>
<li>DHCP客户使用的UDP端口号为68</li>
<li>DHCP服务器使用的UDP端口号为67</li>
</ul>
</li>
<li>DHCP客户在未获取到IP地址时使用地址0.0.0.0</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639484047086-f1321b7b-89a8-4cc5-b406-2a8335855ccc.png">

<ul>
<li>在每一个网络上都设置一个DHCP服务器会使DHCP服务器的数量太多。因此现在是使每一个网络至少有一个DHCP中继代理（通常是一台路由器)，它配置了DHCP服务器的IP地址信息，作为各网络中计算机与DHCP服务器的桥梁。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639484096989-073829fb-e4ac-4d7c-a818-60c341f1b51e.png">

<h3 id="（四）、域名系统DNS"><a href="#（四）、域名系统DNS" class="headerlink" title="（四）、域名系统DNS"></a>（四）、域名系统DNS</h3><h3 id="1、域名系统DNS的作用"><a href="#1、域名系统DNS的作用" class="headerlink" title="1、域名系统DNS的作用"></a>1、域名系统DNS的作用</h3><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639484446465-a208b106-bced-44c0-a34f-95d3656c1183.png">
因特网是否可以只使用一台DNS服务器?
这种做法并不可取。因为因特网的规模很大，这样的域名服务器肯定会因为超负荷而无法正常工作，而且一旦域名服务器出现故障，整个因特网就会瘫痪。
早在1983年，因特网就开始采用层次结构的命名树作为主机的名字(即域名),并使用分布式的域名系统DNS.
DNS使大多数域名都在本地解析，仅少量解析需要在因特网上通信，因此系统效率很高。
由于DNS是分布式系统，即使单个计算机出了故障，也不会妨碍整个系统的正常运行。

<h3 id="2、域名结构"><a href="#2、域名结构" class="headerlink" title="2、域名结构"></a>2、域名结构</h3><ul>
<li>因特网采用层次树状结构的域名结构</li>
<li>域名的结构由若干个分量组成，各分量之间用“点”隔开，分别代表不同级别的域名。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639484584333-b854f4fd-a701-4f03-b119-7f5c6ef1cb9a.png">

<ul>
<li>每一级的域名都由英文字母和数字组成，不超过63个字符，不区分大小写字母</li>
<li>级别最低的域名写在最左边，而级别最高的顶级域名写在最右边。</li>
<li>完整的域名不超过255个字符。</li>
<li>域名系统既不规定一个域名需要包含多少个下级域名，也不规定每一级的域名代表什么意思。</li>
<li>各级域名由其上一级的域名管理机构管理，而最高的顶级域名则由因特网名称与数字地址分配机构ICANN进行管理。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639484665523-ecc169e8-b9c6-4bfe-a082-285fc7f38e3e.png">

<h4 id="域名分类"><a href="#域名分类" class="headerlink" title="域名分类"></a>域名分类</h4><ul>
<li>顶级域名TLD (Top Level Domain)分为以下三类:<ul>
<li>国家顶级域名nTLD		采用ISO 3166的规定。如cn表示中国，us表示美国，uk表示英国、等等。</li>
<li>通用顶级域名gTLD		最常见的通用顶级域名有七个，即: com(公司企业) ,net(网络服务机构).org (非营利性组织)、int(国际组织)、edu(美国教育结构)、gov(美国政府部门) . mil(美国军事部门)。</li>
<li>反向域arpa		用于反向域名解析，即IP地址反向解析为域名。</li>
</ul>
</li>
<li>在国家顶级域名下注册的二级域名均由该国家自行确定。例如，顶级域名为jp的日本，将其教育和企业机构的二级域名定为ac和co，而不用edu和com。</li>
<li>我国则将二级域名划分为以下两类:<ul>
<li>类别域名		共七个: ac(科研机构)、com (工、商、金融等企业).edu(教育机构)．gov(政府部门).net(提供网络服务的机构).mil(军事机构）和org (非营利性组织)。</li>
<li>行政区域名共34个，适用于我国的各省、自治区、直辖市。例如: bj为北京市、sh为上海市、js为江苏省，等等。</li>
</ul>
</li>
</ul>
<h4 id="域名空间"><a href="#域名空间" class="headerlink" title="域名空间"></a>域名空间</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639484954381-ade30cd4-5c7e-400d-b6a1-ab5447da8f34.png">

<h4 id="域名服务器"><a href="#域名服务器" class="headerlink" title="域名服务器"></a>域名服务器</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639485061621-d3ac4b02-b8e9-4042-a7ab-942245f2a1e2.png">

<h4 id="域名解析的过程"><a href="#域名解析的过程" class="headerlink" title="域名解析的过程"></a>域名解析的过程</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639487254966-37e236dd-89e4-43d2-a715-6ea9368ecd96.png">

<ul>
<li>为了提高DNS的查询效率，并减轻根域名服务器的负荷和减少因特网上的DNS查询报文数量，在域名服务器中广泛地使用了<strong>高速缓存</strong>。高速缓存用来存放最近查询过的域名以及从何处获得域名映射信息的记录。</li>
<li>由于域名到IP地址的映射关系并不是永久不变，为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器并删除超过合理时间的项（例如，每个项目只存放两天)。</li>
<li>不但在本地域名服务器中需要高速缓存，在用户主机中也很需要。许多用户主机在启动时从本地域名服务器下载域名和IP地址的全部数据库，维护存放自己最近使用的域名的高速缓存，并且只在从缓存中找不到域名时才向域名服务器查询。同理，主机也需要保持高速缓存中内容的正确性。</li>
<li>DNS报文使用运输层的UDP协议进行封装，运输层端口号为53</li>
</ul>
<h3 id="（五）、文件传送协议FTP"><a href="#（五）、文件传送协议FTP" class="headerlink" title="（五）、文件传送协议FTP"></a>（五）、文件传送协议FTP</h3><ul>
<li>将某台计算机中的文件通过网络传送到可能相距很远的另一台计算机中，是一项基本的网络应用，即文件传送。文件传送协议FTP (File Transfer Protocol）是因特网上使用得最广泛的文件传送协议。<ul>
<li>FTP提供交互式的访问，允许客户指明文件的类型与格式（如指明是否使用ASCII码)，并允许文件具有存取权限(如访问文件的用户必须经过授权，并输入有效的口令)。</li>
<li>FTP屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间传送文件。</li>
</ul>
</li>
<li>在因特网发展的早期阶段，用FTP传送文件约占整个因特网的通信量的三分之一，而由电子邮件和域名系统所产生的通信量还要小于FTP所产生的通信量。只是到了1995年，万维网WWW的通信量才首次超过了FTP。</li>
</ul>
<p><strong>FTP的常见用途</strong><br>FTP的常见用途是在计算机之间传输文件，尤其是用于批量传输文件。<br>FTP的另一个常见用途是让网站设计者将构成网站内容的大量文件批量上传到他们的Web服务器。</p>
<h4 id="FTP的基本工作原理"><a href="#FTP的基本工作原理" class="headerlink" title="FTP的基本工作原理"></a>FTP的基本工作原理</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639487920625-b932e02d-f252-485d-965e-425ed946c5f0.png">
FTP客户和服务器之间要建立以下两个并行的TCP连接:

<ul>
<li>控制连接，在整个会话期间一直保持打开，用于传送FTP相关控制命令。</li>
<li>数据连接，用于文件传输，在每次文件传输时才建立，传输结束就关闭。</li>
<li>默认情况下，FTP使用TCPZ1端口进行控制连接，TCP20端口进行数据连接。但是，是否使用TCP 20端口建立数据连接与传输模式有关，主动方式使用TCP 20端口被动方式由服务器和客户端自行协商决定。</li>
</ul>
<h3 id="（六）、电子邮件"><a href="#（六）、电子邮件" class="headerlink" title="（六）、电子邮件"></a>（六）、电子邮件</h3><ul>
<li>电子邮件(E-mail)是因特网上最早流行的一种应用，并且仍然是当今因特网上最重要、最实用的应用之一。</li>
<li>传统的电话通信属于实时通信，存在以下两个缺点:<ul>
<li>电话通信的主叫和被叫双方必须同时在场;</li>
<li>一些不是十分紧迫的电话也常常不必要地打断人们的工作或休息。</li>
</ul>
</li>
<li>而电子邮件与邮政系统的寄信相似。<ul>
<li>发件人将邮件发送到自己使用的邮件服务器;</li>
<li>发件人的邮件服务器将收到的邮件按其目的地址转发到收件人邮件服务器中的收件人邮箱;</li>
<li>收件人在方便的时候访问收件人邮件服务器中自己的邮箱，获取收到的电子邮件。</li>
</ul>
</li>
<li>电子邮件使用方便、传递迅速而且费用低廉。它不仅可以传送文字信息，而且还可附上声音和图像。</li>
<li>由于电子邮件的广泛使用，现在许多国家已经正式取消了电报业务。在我国，电信局的电报业务也因电子邮件的普及而濒临消失。</li>
<li>电子邮件系统采用客户&#x2F;服务器方式。</li>
<li>电子邮件系统的三个主要组成构件:用户代理，邮件服务器，以及电子邮件所需的协议。<ul>
<li><strong>用户代理</strong>是用户与电子邮件系统的接口，又称为<strong>电子邮件客户端软件</strong>。</li>
<li><strong>邮件服务器</strong>是电子邮件系统的基础设施。因特网上所有的ISP都有邮件服务器，其功能是<strong>发送和接收邮件</strong>，同时还要负责维护用户的邮箱。</li>
<li>协议包括<strong>邮件发送协议</strong>（例如SMTP)和<strong>邮件读取协议</strong>（例如POP3，IMAP)。</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639488343288-b002418d-0986-4a6d-b67a-a22070c7270e.png">

<h4 id="简单邮件传送协议SMTP-Simple-Mail-Transfer-Protocol-的基本工作原理"><a href="#简单邮件传送协议SMTP-Simple-Mail-Transfer-Protocol-的基本工作原理" class="headerlink" title="简单邮件传送协议SMTP (Simple Mail Transfer Protocol)的基本工作原理"></a>简单邮件传送协议SMTP (Simple Mail Transfer Protocol)的基本工作原理</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639488469449-27c1c2d9-0bbc-4c3a-bd48-86809a5a5653.png">

<h4 id="电子邮件的信息格式"><a href="#电子邮件的信息格式" class="headerlink" title="电子邮件的信息格式"></a>电子邮件的信息格式</h4><p>电子邮件的信息格式并不是由SMTP定义的，而是在RFC 822中单独定义的。这个RFC文档已在2008年更新为RFC 5322。一个电子邮件有信封和内容两部分。而内容又由首部和主体两部分构成。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639488553497-0c1962e4-0fe2-4f06-b6d9-4f7d3b70c19d.png"></p>
<ul>
<li>SMTP协议只能传送ASCII码文本数据，不能传送可执行文件或其他的二进制对象。</li>
<li>SMTP不能满足传送多媒体邮件（例如带有图片、音频或视频数据）的需要。并且许多其他非英语国家的文字(例如中文、俄文、甚至带有重音符号的法文或德文)也无法用SMTP传送。</li>
<li>为解决SMTP传送非ASCII码文本的问题，提出了**多用途因特网邮件扩展MIME **(Multipurpose Internet MailExtensions)<ul>
<li>增加了5个新的邮件首部字段，这些字段提供了有关邮件主体的信息。</li>
<li>定义了许多邮件内容的格式，对多媒体电子邮件的表示方法进行了标准化。</li>
<li>定义了传送编码，可对任何内容格式进行转换，而不会被邮件系统改变。</li>
</ul>
</li>
<li>实际上，MIME不仅仅用于SMTP，也用于后来的同样面向ASCII字符的HTTP。</li>
</ul>
<h4 id="邮件读取"><a href="#邮件读取" class="headerlink" title="邮件读取"></a>邮件读取</h4><p>常用的邮件读取协议有以下两个:</p>
<ul>
<li>邮局协议POP (Post Office Protocol)，POP3是其第三个版本，是因特网正式标准。</li>
</ul>
<p>非常简单、功能有限的邮件读取协议。用户只能以下载并删除方式或下载并保留方式从邮件服务器下载邮件到用户方计算机。不允许用户在邮件服务器上管理自己的邮件。(例如创建文件夹，对邮件进行分类管理等)。</p>
<ul>
<li>因特网邮件访问协议IMAP (Internet Message Access Protocol)，IMAP4是其第四个版本，目前还只是因特网建议标准。</li>
</ul>
<p>功能比POP3强大的邮件读取协议。用户在自己的计算机上就可以操控邮件服务器中的邮箱，就像在本地操控一样，因此IMAP是一个联机协议。</p>
<ul>
<li>POP3和IMAP4都采用基于TCP连接的客户&#x2F;服务器方式。POP3使用熟知端口110，IMAP4使用熟知端口143。</li>
</ul>
<h4 id="基于万维网的电子邮件"><a href="#基于万维网的电子邮件" class="headerlink" title="基于万维网的电子邮件"></a>基于万维网的电子邮件</h4><ul>
<li>通过浏览器登录(提供用户名和口令）邮件服务器万维网网站就可以撰写、收发、阅读和管理电子邮件。这种工作模式与IMAP很类似，不同的是用户计算机无需安装专门的用户代理程序，只需要使用通用的万维网浏览器。</li>
<li>邮件服务器网站通常都提供非常强大和方便的邮件管理功能，用户可以在邮件服务器网站上管理和处理自己的邮件，而不需要将邮件下载到本地进行管理。</li>
<li>这种工作模式在用户浏览器与邮件服务器网站之间使用HTTP协议，而邮件服务器之间使用SMTP协议。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639488925458-87fef3d0-0564-4c6e-9502-76fc8d7ecc0e.png">

<h3 id="（七）、万维网www"><a href="#（七）、万维网www" class="headerlink" title="（七）、万维网www"></a>（七）、万维网www</h3><ul>
<li>万维网www (World Wide Web）并非某种特殊的计算机网络。它是一个大规模的、联机式的信息储藏所，是运行在因特网上的一个分布式应用。</li>
<li>万维网利用网页之间的超链接将不同网站的网页链接成一张逻辑上的信息网。</li>
<li>万维网是欧洲粒子物理实验室的Tim Berners-Lee最初于1989年3月提出的。</li>
<li>浏览器最重要的部分是渲染引擎，也就是浏览器内核。负责对网页内容进行解析和显示。<ul>
<li>不同的浏览器内核对网页内容的解析也有不同，因此同一网页在不同内核的浏览器里的显示效果可能不同;	</li>
<li>网页编写者需要在不同内核的浏览器中测试网页显示效果。</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489246205-800a4e28-43aa-44b9-90d7-9d8c80f7ef22.png">

<ul>
<li>为了方便地访问在世界范围的文档，万维网使用统一资源定位符URL来指明因特网上任何种类“资源”的位置。</li>
<li>URL的一般形式由以下四个部分组成:</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489357467-9aa96ebd-68de-45d7-9ad5-d1b77bd1d24c.png">

<h4 id="万维网的文档"><a href="#万维网的文档" class="headerlink" title="万维网的文档"></a>万维网的文档</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489411370-afaa028c-8f1d-4b49-b679-da7b5a8e918a.png">

<h4 id="超文本传输协议HTTP-HyperText-Transfer-Protocol"><a href="#超文本传输协议HTTP-HyperText-Transfer-Protocol" class="headerlink" title="超文本传输协议HTTP(HyperText Transfer Protocol)"></a>超文本传输协议HTTP(HyperText Transfer Protocol)</h4><p>HTTP定义了浏览器(即万维网客户进程）怎样向万维网服务器请求万维网文档，以及万维网服务器怎样把万维网文档传送给浏览器。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489475525-cd305129-26d5-42b1-91b0-99305fe36584.png"></p>
<ul>
<li>HTTP&#x2F;1.0采用非持续连接方式。在该方式下，每次浏览器要请求一个文件都要与服务器建立TCP连接，当收到响应后就立即关闭连接。<ul>
<li>每请求一个文档就要有两倍的RTT的开销。若一个网页上有很多引用对象（例如图片等)，那么请求每一个对象都需要花费2RTT的时间。</li>
<li>为了减小时延，浏览器通常会建立多个并行的TCP连接同时请求多个对象。但是，这会大量占用万维网服务器的资源，特别是万维网服务器往往要同时服务于大量客户的请求，这会使其负担很重。</li>
</ul>
</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489536001-eb428ec4-4199-4e65-805b-d95c3a099556.png">

<ul>
<li>HTTP&#x2F;1.1采用持续连接方式。在该方式下，万维网服务器在发送响应后仍然保持这条连接，使同一个客户（浏览器）和该服务器可以继续在这条连接上传送后续的HTTP请求报文和响应报文。这并不局限于传送同一个页面上引用的对象，而是只要这些文档都在同一个服务器上就行。<ul>
<li>为了进一步提高效率，HTTP&#x2F;1.1的持续连接还可以使用流水线方式工作，即浏览器在收到HTTP的响应报文之前就能够连续发送多个请求报文。这样的一个接一个的请求报文到达服务器后，服务器就发回一个接一个的响应报文。这样就节省了很多个RTT时间，使TCP连接中的空闲时间减少，提高了下载文档的效率。</li>
</ul>
</li>
</ul>
<h4 id="HTTP的报文格式"><a href="#HTTP的报文格式" class="headerlink" title="HTTP的报文格式"></a>HTTP的报文格式</h4><p>HTTP有两类报文:请求报文和响应报文。<br>HTTP是面向文本的，其报文中的每一个字段都是一些ASCII码串，并且每个字段的长度都是不确定的。<br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489823523-e0a1d2f7-effe-466d-b417-a7d851fcd7b9.png"><br><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489826189-cfbc9ff2-ca90-47cb-91bc-d76f55fcd63d.png"></p>
<h4 id="使用Cookie在服务器上记录用户信息"><a href="#使用Cookie在服务器上记录用户信息" class="headerlink" title="使用Cookie在服务器上记录用户信息"></a>使用Cookie在服务器上记录用户信息</h4><ul>
<li>早期的万维网应用非常简单，仅仅是用户查看存放在不同服务器上的各种静态的文档。因此HTTP被设计为—种无状态的协议。这样可以简化服务器的设计。</li>
<li>现在，用户可以通过万维网实现各种复杂的应用，如网上购物、电子商务等。这些应用往往需要万维网服务器能够识别用户。</li>
<li>Cookie提供了一种机制使得万维网服务器能够“记住”用户，而无需用户主动提供用户标识信息。也就是说，Cookie是一种对无状态的HTTP进行状态化的技术。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639489969694-a801b936-bab1-4e21-a24f-9466c22998c2.png">

<h4 id="万维网缓存与代理服务器"><a href="#万维网缓存与代理服务器" class="headerlink" title="万维网缓存与代理服务器"></a>万维网缓存与代理服务器</h4><ul>
<li>在万维网中还可以使用缓存机制以提高万维网的效率。</li>
<li>万维网缓存又称为Web缓存(Web Cache)，可位于客户机，也可位于中间系统上，位于中间系统上的Web缓存又称为代理服务器(Proxy Server)。</li>
<li>Web缓存把最近的一些请求和响应暂存在本地磁盘中。当新请求到达时，若发现这个请求与暂时存放的请求相同，就返回暂存的响应，而不需要按URL的地址再次去因特网访问该资源。</li>
</ul>
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639490100818-2ca337b7-536c-4ddc-bba7-a2c27672463d.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639490173436-a9326b78-8f98-4862-82d8-0ede237bc224.png">

<h4 id="练习-4"><a href="#练习-4" class="headerlink" title="练习"></a>练习</h4><img src="http://rx4hz3911.hd-bkt.clouddn.com/1639490250021-29cac69f-70c5-4886-aba5-2c132528f75b.png">
<img src="http://rx4hz3911.hd-bkt.clouddn.com/1639490335284-142dfb09-f52c-4f93-b89d-8cc7865a0d7a.png">

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Shen Din</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://dhushen.github.io/2023/07/02/network/">https://dhushen.github.io/2023/07/02/network/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Shen Din</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">
                                    <span class="chip bg-color">计算机网络</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/07/02/hexo-use/">
                    <div class="card-image">
                        
                        <img src="http://rx4hz3911.hd-bkt.clouddn.com/57bd443112573.jpg" class="responsive-img" alt="Hexo使用教程">
                        
                        <span class="card-title">Hexo使用教程</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            本文介绍了hexo的基础命令
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-07-02
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/" class="post-category">
                                    前端技术
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/hexo/">
                        <span class="chip bg-color">hexo</span>
                    </a>
                    
                    <a href="/tags/node-js/">
                        <span class="chip bg-color">node.js</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/07/02/binary-tree/">
                    <div class="card-image">
                        
                        <img src="http://rx4hz3911.hd-bkt.clouddn.com/b923e97ab2c0f2bd0053b23a16d92dcf.jpg" class="responsive-img" alt="二叉树">
                        
                        <span class="card-title">二叉树</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            使用Java实现二叉树
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-07-02
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/" class="post-category">
                                    算法分析
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/">
                        <span class="chip bg-color">二叉树</span>
                    </a>
                    
                    <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
                        <span class="chip bg-color">数据结构</span>
                    </a>
                    
                    <a href="/tags/Java/">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="song"
                   id="004ASqIW3jDcsH"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.4'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023</span>
            
            <a href="/about" target="_blank">Shen Din</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">33.2k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2023";
                        var startMonth = "7";
                        var startDate = "2";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/DhuShen" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:massd2002@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=972023530" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 972023530" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    
        
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/sakura-small.js"><\/script>');
            }
        </script>
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    
    <script>
        (function (i, s, o, g, r, a, m) {
            i["DaoVoiceObject"] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            a.charset = "utf-8";
            m.parentNode.insertBefore(a, m)
        })(window, document, "script", ('https:' == document.location.protocol ? 'https:' : 'http:') +
            "//widget.daovoice.io/widget/6984b559.js", "daovoice")
        daovoice('init', {
            app_id: "651b562f"
        });
        daovoice('update');
    </script>
    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
